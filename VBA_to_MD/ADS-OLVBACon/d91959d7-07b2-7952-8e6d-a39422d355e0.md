

---
ms.Toctitle:Outlook アイテムをスレッドとして管理する
title:Outlook アイテムをスレッドとして管理する
ms.ContentId:d91959d7-07b2-7952-8e6d-a39422d355e0
---
# Outlook アイテムをスレッドとして管理する





          UNRESOLVED_TOKEN_VAL(outlooknv1)では、会話は、同じ主題を共有し、同じスレッドに属しているメッセージをグループ化します。Outlook のユーザー インターフェイスの応答およびその他のフォルダーから関連するメッセージを含む、メッセージ間の関係を視覚的に提供する、テーマ別ビューで会話を展開できます。会話では、メッセージが 2 つを取得する場合などの分岐を含めることも、または複数の応答やディスカッションを独立して拡張から。UNRESOLVED_TOKEN_VAL(outlooknv2)、テーマ別ビューには、フォルダーやストアにわたって同じスレッドのすべてのアイテムが関連しています。



プログラムの観点から同じ会話内のアイテムは、1 つまたは複数の項目の種類に属する異機種混在することはできます。たとえば、会話には、 **MailItem**および**TaskItem**オブジェクトを含めることができます。

 

UNRESOLVED_TOKEN_VAL(outlooknv2)、前に、同じ会話に属する項目のサポートは、 **ConversationIndex**と**ConversationTopic**プロパティ (**件名**のオブジェクトを除くすべての項目の種類) に制限されていました。**ConversationIndex**をオフにすると、 **MailItem**、 **PostItem**、 **SharingItem**オブジェクトに制限されていました。

UNRESOLVED_TOKEN_VAL(outlooknv2)後、は、Outlook は、**会話****会話**オブジェクトとの会話の各項目の**ConversationID**プロパティを使用して、同じスレッドのすべてのアイテムをフォルダーとストア全体に関連するオブジェクトをサポートします。Outlook は、アイテムに基づく**会話**オブジェクトを取得するを有効にするほとんどの項目の種類の**GetConversation**メソッドを提供します。



スレッド ビューは、POP、IMAP、PST、または Microsoft Exchange Server (UNRESOLVED_TOKEN_VAL(ex14long) 以降のバージョン、またはキャッシュ モードで Outlook を実行している場合は Microsoft Exchange Server 2007 以降のバージョン) のストアでサポートされます。**Store** オブジェクトの **IsConversationEnabled** プロパティを呼び出すと、ストアでスレッド ビューがサポートされているかどうかを確認できます。**GetConversation** メソッドを呼び出すと、アイテムが保存されているストアでスレッド ビューがサポートされている場合のみ、スレッドのアイテムに基づいて **Conversation** オブジェクトを取得できます。



スレッドの階層を移動するには、**Conversation** オブジェクトの **GetChildren** メソッド、**GetParent** メソッド、および **GetRootItems** メソッドを呼び出します。スレッドのアイテムに簡単にアクセスできるように、**SimpleItems** コレクションが用意されています。**SimpleItems** コレクション内のアイテムの順序は、スレッド内のアイテムの順序と同じです。このコレクションは、各アイテムの MAPI の **PidTagCreationTime** プロパティによって昇順で並べられます。



スレッド内のアイテムを列挙するには、**Table** オブジェクトを使用します。テーブルの行はスレッドのアイテムを表し、テーブルの列は各アイテムのプロパティを表します。列はカスタマイズできます。**Table** オブジェクトを使用してスレッドのアイテムを取得するには、次の手順を実行します。

1. スレッド内の任意のアイテムのオブジェクトを取得します。
2. ストアでスレッド ビューがサポートされていることを確認するために、アイテムが保存されているストアを表す **Store** オブジェクトの **IsConversationEnabled** プロパティを使用します。スレッド ビューがサポートされているストアにアイテムが保存されている場合のみ、アイテムに基づいて **Conversation** オブジェクトを取得できます。
3. ストアでスレッド ビューがサポートされている場合、そのアイテムの **GetConversation** メソッドを呼び出して、**Conversation** オブジェクトを取得します。
4. **Conversation** オブジェクトの **GetTable** メソッドを呼び出して、**Table** を取得します。
5. これで、**Table** オブジェクトでサポートされるメソッドを使用して、スレッドのアイテムを表す行を列挙し、既定の列を使用して既定のアイテムのプロパティにアクセスできるようになります (または、列をカスタマイズして、アイテムの他のプロパティにアクセスすることもできます)。








**SetAlwaysDelete** メソッドと **SetAlwaysMoveToFolder** メソッドを使用して、既存のスレッド アイテムおよび特定のスレッドで今後受信されるアイテムを、[削除済みアイテム] フォルダーや別のフォルダーにいつでも移動できます。アイテムの移動は、アイテムが保存されている特定のストアでサポートされます。ただし、そのストアが PST ストアなど配信先以外のストアでない場合に限ります。**GetAlwaysDelete** メソッドと **GetAlwaysMoveToFolder** メソッドを使用すると、これらのフォルダーを取得でき、**StopAlwaysDelete** メソッドと **StopAlwaysMoveToFolder** メソッドを使用すると、既存のスレッド アイテムおよびスレッドで今後受信されるアイテムのこれらのフォルダーへの移動を停止できます。




さらに、既存のスレッド アイテムおよびスレッドで今後受信されるアイテムすべてにアクションを適用できます。

- 既存のスレッド アイテムおよびスレッドで今後受信されるアイテムそれぞれについて、分類項目の設定および取得を行うには、**SetAlwaysAssignCategories** メソッドおよび **GetAlwaysAssignCategories** メソッドを呼び出します。
- アイテムを既読または未読にするには、それぞれ **MarkAsRead** メソッドおよび **MarkAsUnread** メソッドを呼び出します。






## Related Topics

[方法: を取得し、選択したスレッドを列挙します。](3bba1e98-b2eb-c53d-354a-bdd899b65a59.md)




