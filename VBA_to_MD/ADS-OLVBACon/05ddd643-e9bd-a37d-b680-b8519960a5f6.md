

---
ms.Toctitle:Outlook オブジェクト モデルでルールを管理する
title:Outlook オブジェクト モデルでルールを管理する
ms.ContentId:05ddd643-e9bd-a37d-b680-b8519960a5f6
---
# Outlook オブジェクト モデルでルールを管理する




**Rules** オブジェクト モデルは、プログラムによるルールの追加、編集、および削除をサポートしています。**Rule** および **Rules** コレクション オブジェクトを使用すると、セッション用に定義されたルールのアクセス、追加、および削除ができます。**RuleAction** および **RuleCondition** オブジェクト、そのコレクション オブジェクト、および派生のアクションと条件オブジェクトは、加えてアクションと条件の編集をサポートします。

>[!NOTE]
>**Rules** のオブジェクト モデルは、Outlook のユーザー インターフェイスの**仕分けルールと通知ウィザード** で作成できるすべての仕分けルールをサポートしているわけではありませんが、使用頻度の高い仕分けルールのアクションと条件の多くをサポートしています。**仕分けルールと通知** ウィザードで作成され、メッセージ (メール アイテム、会議出席依頼、タスクの依頼、ドキュメント、配信済みメッセージ、開封済みメッセージ、投票結果、および不在通知を含む) に適用される仕分けルールもプログラムで作成できます。 





**Store.GetRules** を使用すると、現在のセッションで使われているストアに定義されたルールを表す **Rules** コレクション オブジェクトを取得できます。



現在のセッションに対するルールのセットを取得したら、**Rules.Create** を使用して新しいルールを追加したり、既存のルールを編集したり (ルールを有効または無効にする、ルールの実行順序を変更する、ルールの処理およびルールの条件を変更するなど)、**Rules.Remove** を使用して **Rules** コレクションからルールを削除したりできます。Microsoft Office Outlook 2007 より前のバージョンの Outlook で作成したルールも編集できますが、Office Outlook 2007 以降で作成したルールを以前のバージョンの Outlook で編集することはできません。



**Rules** コレクションに含まれている各ルールを取得するには、**Rules.Item(Index)** を使用して、コレクション内のインデックスを指定します。*Index* には、ルールの名前 (既定のプロパティである **Rule.Name**) または 1 からコレクション内のルールの数を表す **Rules.Count** までの値のどちらかを指定します。**Rule.ExecutionOrder** は、コレクション内のルールの実行順序を示し、**Rules.Items(Index)** の *Index* の数値に直接マップされます。たとえば、`Rules.Item(1)` は **Rule.ExecutionOrder** が 1 のルールを表し、`Rules.Item(2)` は **Rule.ExecutionOrder** が 2 のルールを表します。`Rules.Item(Rules.Count)` は、**Rule.ExecutionOrder** が **Rules.Count** であるルールを表します。



ルールを定義したら、**Rule.Enabled** プロパティを **True** に設定してルールを有効にし、そのルールと有効状態が現在のセッションの終了後にも保持されるように、**Rules.Save** を使用してルールを保存する必要があります。ルールが有効になるのは、そのルールが正常に保存された後だけです。Exchange サーバーへの接続速度が遅い場合、**Rules.Save** は、パフォーマンスの面でコストの高い操作になる可能性があります。このため、ユーザーが操作を取り消すことができるように、進捗ダイアログ ボックスを表示するオプションも用意されています。ユーザーが自動仕分けウィザードで同じルールを編集している場合、または進捗ダイアログ ボックスで操作を取り消した場合、保存処理は失敗します。このような場合は **Rules.Save** からエラーが発生し、ユーザーは、自動仕分けウィザードから表示されたエラー ダイアログ ボックスに応答して競合を解決することになります。



Office Outlook 2007 で作成された 1 つ以上のルールを **Rules.Save** を使用して保存すると、以前のバージョンの Outlook ではそのルールを編集できなくなることを知らせるダイアログ ボックスが表示されます。保存操作を続行するには、ダイアログ ボックスを確認する必要があります。



ルールを実行するには、**Rule.Execute** を使用します。現在のセッションの終了後もルールが有効になるようにするには、ルールを有効にして保存する必要がありますが、ルールの実行は有効状態にかかわらず可能です。ルールを実行するときは、ルールの適用先となるフォルダーを必要に応じて指定できます。既定では、受信トレイにあるすべてのメッセージに対してルールが実行されますが、受信トレイのサブフォルダーは対象になりません。


