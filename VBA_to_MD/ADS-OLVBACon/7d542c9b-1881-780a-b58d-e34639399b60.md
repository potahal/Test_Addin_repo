

---
ms.Toctitle:フォーム領域のアイコンを指定するのには、アドインの使用します。
title:フォーム領域のアイコンを指定するのには、アドインの使用します。
ms.ContentId:7d542c9b-1881-780a-b58d-e34639399b60
---
# フォーム領域のアイコンを指定するのには、アドインの使用します。




エクスプローラー、インスペクター、およびリボン内のアイテムの状態を識別するために使用するカスタム アイコンは、アドインを使用して指定できます。フォーム領域を登録するために使用するフォーム領域マニフェスト XML ファイルを使用して、フォーム領域を拡張するアドイン、およびカスタム アイコンが使用される状況を指定できます。指定された状況が発生すると、適切なアイコンがアドインから取得されます。

## アドインを使用してフォーム領域のアイコンを指定するには

1. **FormRegionStartup** インターフェイスを実装します。フォーム領域を拡張するすべてのアドインは、**FormRegionStartup** インターフェイスを実装する必要があります。Outlook では、このインターフェイスを呼び出して、フォーム領域のレイアウト記憶データを取得します。フォーム領域のアドインの詳細については、「[Extending a Form Region with an Add-in](b1a28a20-a0b8-cc57-7672-da51ec8bb097)」を参照してください。具体的に、カスタム アイコンを指定するには、アドインに **FormRegionStartup** インターフェイスの **GetFormRegionManifest** メソッドを実装してフォーム領域マニフェスト XML ファイルを指定し、さらに、**GetFormRegionIcon** メソッドを実装してエクスプローラー、インスペクター、またはリボンにカスタム アイコンを表示する状況を指定します。たとえば、家庭で発生する種類のタスク (家事) のみを表示するフォーム領域を作成し、このような家事が **IPM.Task** から派生したメッセージ クラス **IPM.Task.Household** に属するとします。この場合、エクスプローラー内で定期的な家事の横に表示される、定期的なアイテムを表す特別なアイコンを **GetFormRegionIcon** メソッドに指定するアドインを使用して、フォーム領域を拡張できます。
2. フォーム領域マニフェスト XML ファイルで、カスタム アイコンを使用する子要素それぞれについて、**icons** 要素の下に値 `addin` を指定します。エクスプローラーまたはインスペクターで Outlook がアイテムを表示する場合、Outlook は特定のメッセージ クラスのアイテムに関連付けられたフォーム領域マニフェストのキャッシュを探します。**icons** 要素の子要素に値 `addin` がある場合、Outlook は **GetFormRegionIcon** を呼び出して対応するアイコンを取得し、メッセージ クラスのアイテムに応じて表示します。最後の例の拡張として、**IPM.Task.Household** に関連付けられたフォーム領域に対するフォーム リージョン領域マニフェスト XML ファイルで、**icons** 要素の下に、**recurring** 子要素に対して値 `addin` を指定できます。Outlook がエクスプローラーのすべてのタスクを表示する場合に、Outlook は **IPM.Task.Household** に属するアイテムを、キャッシュされたフォーム領域マニフェストで探します。Outlook が **recurring** 要素に値 `addin` が設定されていることに気が付くと、Outlook は  **GetFormRegionIcon** を呼び出して、再帰的な household タスクのアイコンを取得し、この種類のタスクに隣接した特別な再帰的アイコンをエクスプローラーに表示します。**icons** 要素の子要素の詳細については、「[How to: Specify Icons to be Displayed for a Form Region](9ffb9f46-a3b9-d90c-6771-9cd9f9b2e04a.md)」を参照してください。





