

---
ms.Toctitle:フォーム領域を作成します。
title:フォーム領域を作成します。
ms.ContentId:695b95a5-c795-cb4a-8d35-ba12b0007b1f
---
# フォーム領域を作成します。




ここでは、フォーム領域を作成するときの手順と注意事項を示します。



フォームをカスタマイズする方法やフォーム内にフォーム領域を配置する位置に応じて、さまざまな種類のフォーム領域があります。フォーム領域を使用すると、既定のページに別のユーザー インターフェイスを追加したり、標準フォームに別のページを追加することができます。標準フォームの既定のページや標準フォーム全体を置き換え、派生メッセージ クラスの新しいフォームを作成することもできます。フォーム領域の種類は、フォーム領域マニフェスト XML ファイルで、<formRegionType> タグを使用して指定します (手順 7. 参照)。この部分を除いては、いずれの種類のフォーム領域も、次に示す方法で作成およびデザインできます。

1. フォーム デザイナーを使用してレイアウトを作成する (手順 1. ～ 5.)。
2. フォーム領域を Outlook Form Storage (.OFS) ファイルに保存する (手順 6.)。
3. フォーム領域マニフェスト XML ファイルを作成して、フォーム領域に関するその他の詳細を UNRESOLVED_TOKEN_VAL(outlooknv1) に対して指定する (手順 7.)。
4. フォーム領域をメッセージ クラスに登録する (手順 9.)。




Outlook を再起動すると、作成したフォーム領域が使用できるようになります。別の方法として、フォーム領域とフォーム領域マニフェスト XML ファイルを作成して、アドインを使用してフォーム領域を拡張し、フォーム領域をプログラムで登録することもできます。アドインをインストールすると、フォーム領域を含むフォームもインストールされます。詳細については、「[フォーム領域をアドインで拡張する](b1a28a20-a0b8-cc57-7672-da51ec8bb097.md)」を参照してください。



以降では、アドインを使用せずに、フォーム デザイナーを使用してフォーム領域を作成する手順を示します。

1. [**開発**] タブの [**ユーザー設定フォーム**] で、[**フォームのデザイン**] をクリックします。
2. Outlook の 9 つの標準フォーム (予定、連絡先、履歴、会議出席依頼、メッセージ、投稿、RSS 記事、タスク、タスクの依頼) から、目的に合致するものを選択します。フォームをカスタマイズするときは、常に標準フォームをテンプレートとして、それに変更を加えることになります。標準フォームの選択にあたっては、次の事項を検討する必要があります。
    - フォームに関連付けられたアクション (フォームを他の人に送信する場合は "メッセージ" フォームを選択する必要があるなど)。
    - フォーム内に必要なフィールドの種類 (連絡先特有のフィールドが大部分を占めるかどうかなど)。

3. カスタマイズの範囲を計画するため、次の点を検討します。標準フォームの既定のページの下端に別のコントロールを追加するだけで十分かどうか。別のカスタムのページが必要かどうか。ユーザー インターフェイスを大幅に変更する必要があるため、新しいフォームを作成する方が簡単であるか。ただし、新しいフォームでフォーム上のページを置換できるのは、そのフォームを派生メッセージ クラスに指定した場合のみです。
4. フォーム デザイナーで、[**開発**] タブの [**デザイン**] グループで、**新しいフォーム領域**をクリックします。フォーム デザイナーで、別のページとして任意の種類のフォーム領域を開くことに注意してください。、実行時にフォーム領域が表示されます、フォーム領域マニフェスト XML ファイルで指定した方法 7 の手順で説明しました。
5. フォーム領域のレイアウトをデザインするには、ドラッグしてコントロールをツールボックスから、フォーム領域にドロップして、適切なフィールドにバインドします。フォーム ページをカスタマイズすると同様に、フォーム領域をカスタマイズするには、コントロール ツールボックスを使用して、コントロールにバインドするフィールドの選択] を使用してフィールドを挿入すること、ユーザー設定のフィールドを定義します。詳細についてを参照してください[ユーザー設定フォーム内のコントロール](fcba1b34-c526-5d01-8644-cb8852bd2348)とセクション、フォーム領域のデザインで[チュートリアル: フォーム上の既存のページにフォーム領域を追加する](3c988dac-f171-966d-cf9a-17139353d604.md)です。必要に応じて、コントロールのイベントをプログラムで使用できます。
6. [**デザイン**] で [**領域の保存**] をクリックし、[**フォーム領域の保存**] をクリックして、フォーム領域のレイアウトを保存します。拡張子 .OFS のフォーム領域のレイアウト ファイルが保存されます。
7. フォーム領域マニフェスト XML ファイルを作成するのにには、メモ帳などの XML エディターを使用します。Outlook と、それをサポートしているアクションを表示する方法を指示する各フォーム領域の XML を指定する必要があります。XML は、フォーム領域マニフェストのスキーマに対して検証する必要があります (スキーマに関する詳細については、 [MSDN ライブラリ](http://msdn.microsoft.com/library)で Microsoft Outlook 2010 の XML スキーマ リファレンスを参照してください)。よく使用されるものは、以下に示すように、スキーマは、多くの要素をサポートしています。
    - <addin> タグは、フォーム領域を管理し、その記憶域を提供するアドインのプログラム ID を指定します。このタグを使用する必要があるのは、フォーム領域の作成および管理にアドインを使用する場合のみです。
    - <customActions> タグは、返信や転送など、フォーム領域によってサポートされるアクションを指定します。
    - <displayAfter> タグは、同じフォーム内で現在のフォーム領域の前にあるフォーム領域を指定します。この情報は、同じフォームに含まれる複数の付加フォーム領域、または複数の個別フォーム領域の初期状態における順序を定義します。
    - <formRegionType> タグは、フォーム領域が追加フォーム領域 (付加フォーム領域または個別フォーム領域) であるか、代替のフォーム領域または全置換フォーム領域 (既定のページまたは標準フォーム全体と置き換えられ、派生メッセージ クラスの新しいフォームとなる個別フォーム領域) であるかを指定します。
    - <layoutFile> タグは、.OFS ファイルが存在する場合に、その場所を指定します。このファイル パスを含む .OFS ファイル内のすべてのパスは、レジストリで指定されたフォーム領域マニフェスト XML ファイルの場所を基準とした相対パスで指定できます。ただし、UNC パスはサポートされていません。アドインを使用してフォーム領域を作成および管理する場合は、このタグではなく <addin> タグを指定する必要があります。
    - <name> タグは、コード内でのみ使用されるフォーム領域の名前を指定します。
    - <title> タグは、[**処理**] メニューと [**フォームの選択**] ダイアログ ボックスに表示される個別フォーム領域の表示名を指定します。
    - <icons> タグは、アイコン ファイルの場所を指定します。

>[!NOTE]
>既定では、アイコン ファイルは、同じフォルダーに、または、フォーム領域マニフェスト XML ファイルの相対パスをたとえば、アイコン ファイルの完全パスを指定することも。>`<icons><default>c:\myicon.ico</default></icons>`>または、たとえば、リソース ファイルの完全パス:>`<icons><unread>c:\myresource.dll,101</unread> </icons>`>アイコン リソース 101 をリソース ファイル c:\myresource.dll が読み込まれます。ただし、アドイン アセンブリ ファイルに埋め込まれたアイコンを指定する明示的な規則を使わないでください。例です。>`<icons><read>,102</read></icons>`>サポートされていないと、アイコン リソース 102 をアドイン dll は読み込まれません。



8. Outlook を閉じます。
9. このフォーム領域を目的として、メッセージ クラス] および [フォーム領域マニフェスト XML ファイルのファイルの完全パスを指定する、Windows レジストリでフォーム領域を登録します。Windows レジストリの**HKEY_CURRENT_USER**または**HKEY_LOCAL_MACHINE**ハイブにフォーム領域を登録します。などの付加フォーム領域を IPM の**です。連絡先****HKEY_CURRENT_USER\Software\Microsoft\Office\Outlook\FormRegions\IPM 同じキーの下の現在のユーザーのメッセージ クラスを登録する必要があります。連絡先**。**IPM に適用されるすべてのフォームの現在のユーザーのフォーム領域が表示されることに注意してください。連絡先**し、任意のメッセージ クラスが IPM の**から派生します。連絡先**。**IPM にのみ使用するフォーム領域を実行する場合にします。連絡先**し、そのフォーム領域を使用する派生メッセージ クラスを作成したくないことを指定するこのフォーム領域マニフェスト XML ファイルで < exactMessageClass > タグを使用しています。
10. Outlook を起動します。手順 9. でフォーム領域に指定したメッセージ クラスのアイテムを開くと、インスペクターにフォーム領域が表示されます。



