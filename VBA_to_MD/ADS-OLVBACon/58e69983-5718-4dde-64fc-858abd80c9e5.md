

---
ms.Toctitle:ソリューションのデータを保存する
title:ソリューションのデータを保存する
ms.ContentId:58e69983-5718-4dde-64fc-858abd80c9e5
---
# ソリューションのデータを保存する




このトピックでは、開発者が個人用のソリューション データを保存する手段としての **StorageItem** オブジェクトの使い方について説明します。



Outlook ソリューションの開発者にとっては、個人用のアプリケーション データを格納して維持する場所が必要になることがよくあります。たとえば、注文番号を保存して、番号を 1 ずつ増やしていくことが必要な場合があります。Outlook オブジェクト モデルには、このような個人用データを格納するための **StorageItem** オブジェクトが用意されています。



**StorageItem** オブジェクトは、MAPI のメッセージ オブジェクト (**IMessage** オブジェクト) に対する薄いラッパーです。オブジェクトに対応するアイテムがフォルダーに表示されないように、このオブジェクトは常に親の MAPI フォルダーの関連部分に保存されます。これは **Folder** オブジェクトの子オブジェクトです。つまり、ソリューションの個人用データは実際にはフォルダー レベルで格納されるため、メールボックスと一緒に移動することができ、オンラインでもオフラインでも利用可能です。



**StorageItem** オブジェクトは、件名、メッセージ クラス、またはエントリ ID を使用して識別できます。**StorageItem** オブジェクトは、1 つのソリューションだけに厳密に関連付けられるわけではありません。そのため、1 つのフォルダーまたは複数のフォルダーに 1 つ以上の **StorageItem** オブジェクトを作成できます。同じソリューションの複数のインスタンス、または連携して動作する複数のソリューションの間で、個人用のストレージに格納されているデータを共有することもできます。



ソリューション データを格納するには、新しい **StorageItem** オブジェクトを作成するか、または既存の **StorageItem** オブジェクトを取得できます。データは添付ファイルまたはアイテム プロパティの値として格納できます。アプリケーションのストレージをクリーンアップするには、そのアプリケーションが使用している **StorageItem** オブジェクトを削除すると、該当するオブジェクトが完全に取り除かれます。



Outlook オブジェクト モデルには、**StorageItem** オブジェクト用のコレクション オブジェクトは用意されていません。ただし、*TableContents* パラメーターを **olHiddenItems** に設定しているときは、**Folder.GetTable** を使用して、**Folder** 内のすべての隠しアイテムが含まれた **Table** を取得することができます。データの秘密保持がきわめて重要な場合は、データを暗号化してから保存します。


