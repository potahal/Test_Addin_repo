

---
ms.Toctitle:フォームをアイテムと一緒に保存する (1 回限りのフォーム)
title:フォームをアイテムと一緒に保存する (1 回限りのフォーム)
ms.ContentId:0983163c-6ae0-a391-ae31-afd7ec796d4b
---
# フォームをアイテムと一緒に保存する (1 回限りのフォーム)





>[!NOTE]
>このヘルプ トピックでは、フォーム ページを使用してカスタマイズされたフォームの保存方法について説明しますが、フォーム領域を使用してカスタマイズされたフォームについては取り上げません。フォーム領域の場合は、[**フォーム領域**] をクリックし、[**フォーム領域に名前を付けて保存**] をクリックして、フォーム領域のレイアウトを保存します。フォーム領域のレイアウト ファイルは、.ofs 拡張子を付けて保存されます。次に、フォーム領域マニフェスト XML ファイルを作成し、Windows レジストリにフォーム領域を登録する必要があります。詳細については、「[使い方: フォーム領域を作成する](695b95a5-c795-cb4a-8d35-ba12b0007b1f.md)」を参照してください。



## フォーム ページを使用してカスタマイズされたフォーム 
UNRESOLVED_TOKEN_VAL(outlooknv1) でユーザー設定フォームを使用してソリューションを作成する場合は、Outlook がフォルダー内のアイテムに関連してユーザー設定フォームをどのように使用するかを理解することが重要です。



たとえば、既定の Outlook 連絡先フォームに代わるユーザー設定の連絡先フォームを作成する場合、通常は次の手順に従います。

1. ユーザー設定フォームの基として使用する、既定の新しい連絡先アイテムを準備します。
2. 必要に応じてフォームを変更します。
3. フォームを "**連絡先**" フォルダーに発行します。
4. フォルダー プロパティを変更して、フォームを "**連絡先**" フォルダーの既定のフォームとして設定します。




この典型的なシナリオでは、フォームに関する情報 (フォーム定義) が各アイテムと共に保存されることはありません。フォームは、フォームが発行された場所に格納され、"**メッセージ クラス**" フィールドを使用して参照されます。このように、各アイテムには関連するデータしか格納されないため、アイテムのサイズは比較的小さくなります。



ただし、Outlook では、フォルダー内の個々のアイテムの中にフォーム定義を保存することもできます。このようなアイテムは 1 回限りのアイテムと呼ばれ、発行されたフォームではなく、アイテム内に格納されているフォーム定義を常に使用します。



通常は、フォーム定義をアイテム内に保存しないでください。例外としては、電子メール メッセージのユーザー設定フォームが最も一般的です。Microsoft Exchange Server を使用している場合は、電子メール メッセージのユーザー設定フォームを組織用フォーム ライブラリに発行することで、組織内のすべてのユーザーがいつでもそのフォームを使用できるようになります。この方法を使用すれば、フォーム定義をアイテム内に保存する必要はありません。ただし、Exchange Server を使用していない場合、またはフォームを使用できない別の組織にフォームを送信する場合は、デザイン モードのときに、フォームの [**プロパティ**] ページで [**フォームのレイアウトも送信**] チェック ボックスをオンにする必要があります。これにより、セキュリティ制限に応じて、受信者もユーザー設定フォームを使用して電子メール メッセージを表示できるようになります。

>[!NOTE]
>受信者がユーザー設定フォームを表示できない場合は、ユーザー設定の電子メール フォームの [**開封**] ページをカスタマイズまたは無効にしているかどうかを確認してください。





ユーザー設定フォームに Microsoft Visual Basic Scripting Edition (VBScript) が含まれている場合は、そのフォームを Exchange Server の組織用フォーム ライブラリに発行しない限り、マクロ ウイルスの警告が表示されます。



一般に、次のような状況では、アイテムが 1 回限りのアイテムになります。

- フォルダー ベースのソリューションがあり、フォームはフォルダーに発行され、アイテムは発行済みのフォームを使用しているとしま。フォルダー内の既存のアイテムを開き、デザイン モードでフォームを変更してから、アイテムを保存します。フォーム定義が変更され、フォームが再発行されていないため、Outlook はアイテムを使用して新しいフォーム定義を保存します。フォルダー内のすべてのアイテムのフォームを変更するには、既存のアイテムを開く代わりに、次の手順に従います。
    1. ユーザー設定フォームに基づく新しいアイテムを開きます。
    2. そのアイテムのフォーム デザインを変更します。
    3. 同じ名前でフォームを再発行します。
    4. アイテムを閉じます。アイテムの変更は保存しないでください。
フォルダー内のすべてのアイテムは次回開かれる際にカスタム フォームを使用します。これは、アイテムのメッセージ クラスが引き続き公開されているフォームを参照するためです。
- カスタム フォーム内の VBScript コードにより、アイテムのフォーム定義が変更されたとします。アイテム内の VBScript コードによってフォームが変更されると、多くの場合、アイテムと共にフォーム定義が保存されます。この動作が最もよく発生するのは、Outlook オブジェクト モデルの次のメソッドを使用した場合です。
    - **UserProperties.Add** メソッド
    - **FormDescription** オブジェクトのメソッドとプロパティ
    - **Enabled** など、コントロールの一部のメソッドまたはプロパティ
    - **Actions** コレクション オブジェクトのメソッドとプロパティ





解決方法と状況は大きく異なりますが、アイテムが 1 回限りのアイテムになったことを示している可能性のある兆候に注意してください。

- フォーム内の VBScript コードが実行されないか、マクロ ウイルスの警告が予期せず表示される場合。後者の場合、発行済みのフォームだけでなく、アイテム自体に VBScript コードが含まれていることを示しています。
- アイテムのサイズが予想外に増えている場合。
- アイテムのアイコンが予期せず変更されている場合。





