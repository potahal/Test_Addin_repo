

---
ms.Toctitle:Outlook オブジェクト モデルのセキュリティ警告
title:Outlook オブジェクト モデルのセキュリティ警告
ms.ContentId:7e0cd805-5104-73af-d74f-b00480db91c4
---
# Outlook オブジェクト モデルのセキュリティ警告




クライアント コンピューター上のアプリケーションを信頼するか否かに関する Outlook 側の設定にもよりますが、アプリケーションが Outlook オブジェクト モデルを使ってあるデータにアクセスし、またはあるアクションを実行しようとしたとき、セキュリティ警告が現れる場合があります。そのデータやアクションの種類により、オブジェクト モデル ガードを介して起動されるセキュリティ ダイアログには、アドレス帳、メッセージ送信、アクション実行の 3 種類の警告があります。
このトピックでは、上記の 3 種類のセキュリティ警告について説明します。セキュリティに関する Outlook の既定の動作や設定項目の詳細については、「[Outlook オブジェクト モデルにおけるセキュリティ動作](4aa3b7c7-5f3f-41ce-bbf3-75d8ecbd6d4f)」を参照してください。オブジェクト モデルの中で、セキュリティ警告が発生しうるエントリ ポイントについては、「[保護されたプロパティとメソッド](8522d350-a257-2924-2260-3cc02b6ebbca.md)」を参照してください。


## 「アドレス帳」警告
![](..\media\OfficeOutlookCodeSecurity_Fig2_ZA10167364.gif)



信頼できないアプリケーションが Outlook データにアクセスしようとしたときによく現れるセキュリティ警告です。トピック「[保護されたプロパティとメソッド](8522d350-a257-2924-2260-3cc02b6ebbca.md)」で、「アドレス帳」ダイアログに関連するものとして挙げたエントリ ポイントで発生します。



ユーザーはこの警告に応じて、アクションを許可するか禁止するかを指定できます。また、アドレス帳へのアクセスを一定期間のみ許可し、その期間をドロップダウン ボックスで指定することも可能です。




ユーザーが [**拒否**] をクリックすると、Outlook はただちにこの警告の原因となった呼び出しを拒否し、**MAPI_E_NOT_SUPPORTED** を返します。呼び出し元にデータを返すことはありません。適切にエラーを処理できないプログラムの場合、クラッシュする可能性もあります。




[**アクセスを許可する時間**] をオフにした状態で [**許可**] をクリックすると、この警告の原因となった呼び出しだけが許可されます。同じ行にある他の呼び出しや、拒否された呼び出しから派生するオブジェクトに対する呼び出しがあると、改めてセキュリティ警告が発生することがあります。




[**アクセスを許可する時間**] をオンにした状態で [**許可**] をクリックすると、警告ダイアログの原因となった呼び出しだけでなく、指定した時間内であれば他の呼び出しも許可されます。この間、セキュリティ警告の原因となった呼び出しを含む、オブジェクト モデルに対する呼び出しすべてに、アドレス帳へのアクセスが承認されるのです。この時間経過後はセキュリティ警告が再び現れるようになります。




## 「メッセージ送信」警告
![](..\media\OfficeOutlookCodeSecurity_Fig3_ZA10167831.gif)



信頼できないソリューションからアイテムが送信された場合に現れます。このダイアログ ボックスにはタイマーが組み込まれていて、信頼できないアドインが自動的に短い間隔で繰り返しメッセージを送信することのないようにしています。ユーザーは、[**許可**] をクリックする場合でも、5 秒間待たなければなりません。



ユーザーが [**拒否**] をクリックすると Outlook はこの呼び出しを拒否し、**MAPI_E_NOT_SUPPORTED** エラーを返します。以後もプログラム的にメッセージを送信する呼び出しがあると、その都度警告を出します。




[**許可**] をクリックすると、この警告の原因となった呼び出しだけが許可されます。これ以降、信頼できないソリューションからプログラム的にメッセージが送信された場合、改めて警告が発生します。




## 「アクション実行」警告
![](..\media\OfficeOutlookCodeSecurity_Fig4_ZA10167832.gif)



信頼できないソリューションが、**Actions** コレクションから独自のアクションを実行しようとしたときに発生します。アクションが実行されたことを表す、前記の警告の場合と同様のメッセージが表示されます。



ユーザーが [**拒否**] をクリックすると、Outlook はそのアクションを実行する **Execute** メソッドの呼び出しを拒否し、**MAPI_E_NOT_SUPPORTED** エラーを返します。




[**許可**] をクリックすると、この警告の原因となった呼び出しだけが許可されます。これ以降、信頼できないソリューションからプログラム的にメッセージが送信された場合、改めて警告が発生します。





