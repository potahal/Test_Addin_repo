

---
ms.Toctitle:フォーム上の既存のページにフォーム領域を追加します。
title:フォーム上の既存のページにフォーム領域を追加します。
ms.ContentId:3c988dac-f171-966d-cf9a-17139353d604
---
# フォーム上の既存のページにフォーム領域を追加します。




このチュートリアルでは、標準的な Contact フォームの [**全般**] ページの末尾に、別途作成したフォーム領域を追加する方法を示します。次の手順から成ります。

1. 追加しようとするフォーム領域をフォーム デザイナーで作成し、Contoso.ofs という名前で、Outlook Form Storage (.OFS) ファイルに保存します。
2. メモ帳などのテキスト エディターを使って、フォーム領域のマニフェスト XML ファイルを作成します。これは、フォーム領域をどのように表示するか (題名、ローカライズされた操作名など)、何に使うか (カスタム操作、アドイン サポートなど) を Outlook に示すのが目的です。
3. Windows レジストリ エディターを使って、フォーム領域とそのメッセージ クラスを登録します。メッセージ クラスには、このフォーム領域を使うべきアイテムの種類を、Outlook に対して示す役割があります。
4. Outlook を再起動して、更新された Contact フォームが使われるようにします。








フォーム領域の設計



フォーム領域の作成や設計にはフォーム デザイナーを使います。フォーム ページをカスタマイズする場合と同様、コントロール ツールボックスからフォーム領域にコントロールを追加し、必要に応じてコントロールをフィールドにバインドする、という手順です。このフォーム領域を、次の手順で連絡先フォームの [**全般**] ページの末尾に追加することになります。ここには 6 つのコントロールを挿入します。次に、ユーザー定義フィールドを 3 つ作成し、コントロールとバインドします。この後、フォーム領域を .OFS ファイルに保存します。こうして作成される連絡先フォームの [**全般**] ページを図 1 に示します。

![図 1。カスタマイズされた連絡先フォームの、実行時の表示。ここで作成したフォーム領域が [全般] ページの末尾に表示されている様子。](29e12b28-d133-cfa6-bd72-45fb50a20e4b.md)


1. Outlook の Microsoft Office Fluent リボンの [**開発者**] タブで、[**フォームのデザイン**] をクリックします。
2. [**フォームのデザイン**] ボックスで、図 2 のように、[**連絡先**] をクリックし、次に [**開く**] をクリックします。 ![図 2。カスタマイズの基礎となる、標準のフォームを選択している様子。](94429c9c-f098-e3da-631f-b5164ea322c0.md)
3. フォーム デザイナーで、図 3 のように、[**フォーム領域**] をクリックし、[**新しいフォーム領域**] をクリックします。 ![図 3。フォーム領域を作成する様子。](ee489038-1105-4d42-88ea-09dceb8b9f7e.md)
4. 次に、Frequent Flyer Number、Vegetarian、Seat Preference という 3 つのユーザー定義フィールドを作成します。[フィールドの選択] ダイアログ ボックスが自動的に表示されない場合は、図 4 のように、[**フィールドの選択**] をクリックします。 ![図 4。[フィールドの選択] ダイアログ ボックスでユーザー定義フィールドを作成する様子。](d3903f20-88a1-dac5-d398-178d1f96a94f.md)
5. [**新規フィールド**] をクリックします。**名前**として**Frequent Flyer Number**と入力 (図 5 を参照) し、[**OK**] をクリックすると、Frequent Flyer Number というカスタム テキスト フィールドが作成されます。 ![図 5。ユーザー定義フィールド Frequent Flyer Number を作成している様子。](ac5b6e4c-58da-f7cc-9705-3cce6c41acac.md)
6. [**新規フィールド**] をクリックします。**名前**として **Vegetarian** と入力し、[**種類**] として [**はい/いいえ**]、[**書式**] として [**はい/いいえ**] を選択 (図 6 を参照) し、[**OK**] をクリックすると、Vegetarian というはい/いいえ型フィールドが作成されます。 ![図 6。ユーザー定義フィールド Vegetarian を作成している様子。](dc73ec25-2cf8-005b-f203-a5aa784f6a22.md)
7. [**新規フィールド**] をクリックします。[**名前**]として [**Seat Preference**] と入力し、[**種類**] として [**テキスト**] を選択 (図 7 を参照) し、[**OK**] をクリックすると、Seat Preference というカスタム テキスト フィールドが作成されます。 ![図 7。ユーザー定義フィールド Seat Preference を作成している様子。](fccdeb21-2e4e-a24a-ff13-320874d3baae.md)
8. 手順 9 ～ 12 では、フォーム領域内に Outlook コントロールを 6 つ挿入します。

>[!NOTE]
>コントロール ツールボックスは Microsoft Forms 2.0 コントロールでのみ初期化されています。フォーム領域に Forms 2.0 コントロールを挿入する場合に、Outlook のテーマに対応する部分が Outlook コントロールとして存在する場合、Outlook は Forms 2.0 コントロールをテーマの対応する部分に自動で置き換えます。このチュートリアルでは、1 つのチェック ボックス コントロール、1 つのコンボ ボックス コントロール、3 つのラベル コントロール、および 1 つのテキスト ボックス コントロールを含む 6 つのコントロールを挿入します。既定では、これらのコントロールの Forms 2.0 バージョンがツールボックスに存在します。これらのコントロールをフォーム領域に挿入すると、Outlook はこれらのコントロールを常にテーマの外観で表示しますので、Outlook の対応するコントロールをツールボックスに追加する必要はありません。なぜなら、Forms 2.0 コントロールをツールボックスからフォーム領域に挿入した後に Outlook がそれらを Outlook テーマの対応するコントロール、UNRESOLVED_TOKEN_VAL(outlooknv1) チェック ボックス コントロール、UNRESOLVED_TOKEN_VAL(outlooknv1) コンボ ボックス コントロール、UNRESOLVED_TOKEN_VAL(outlooknv1) ラベル コントロール、および UNRESOLVED_TOKEN_VAL(outlooknv1) テキスト ボックス コントロールに置き換えるためです。ただし、既定でツールボックスに存在しないその他の UNRESOLVED_TOKEN_VAL(outlooknv1) コントロール (たとえば、UNRESOLVED_TOKEN_VAL(outlooknv1) 受信者コントロールおよび UNRESOLVED_TOKEN_VAL(outlooknv1) 送信者写真コントロール) があります。これらの Outlook コントロールを初めて使用する場合は、ツールボックスの下部を右クリックして [**カスタム コントロール**] をクリックすることにより、それらをツールボックスに追加する必要があります。

これから作成するフォーム領域のレイアウトを図 8 に示します。手順 9、10、11、12 で、ツールボックスからコントロールを挿入し、そのうちいくつかにはユーザー定義フィールドをバインドします。![図 8。フォーム デザイナーでこれから作成するフォーム領域。](8c90ed08-780c-6d3b-740d-a5bcf1678c3d.md)
9. フォーム領域のタイトルにラベル コントロール [**Contoso Airlines**] を追加します。
    1. 図 8 で示すように、ラベル コントロールを選択してクリックし、ツールボックスからフォーム領域に追加します。

>[!NOTE]
>ドラッグ アンド ドロップの代わりにピック アンド クリックを使用して、コントロールをツールボックスからフォーム領域に挿入することで、コントロールをフォーム領域に適切な既定サイズで挿入できます。


    2. ラベル コントロールを右クリックして [**プロパティ**] をクリックします。[**表示**] タブで[**キャプション**]として [**Contoso Airlines**] と入力します。
    3. [**フォント**] をクリックして、[**サイズ**] から [**14**] を選択して [**OK**] をクリックします。
    4. [**OK**] を選択します。
    5. ラベル コントロールの右ハンドルをマウスでプルし、キャプションの長さに合わせて幅を調整します。

10. ラベル コントロールおよびテキスト ボックスを追加して、Frequent Flyer Number フィールドをテキスト ボックス コントロールにバインドします。
    1. 図 9 で示すように、別のラベル コントロールをピック アンド クリックでツールボックスからフォーム領域に追加します。
    2. ラベル コントロールを右クリックして [**プロパティ**] をクリックします。[**表示**] タブで[**キャプション**]として [**Frequent Flyer Number:**] を入力し、[**OK**] をクリックします。
    3. ラベル コントロールの右ハンドルをマウスでプルし、キャプションの長さに合わせて幅を調整します。
    4. 図 9 で示すように、テキスト ボックス コントロールをピック アンド クリックでツールボックスからフォーム領域に追加します。
    5. テキスト ボックス コントロールを右クリックし、[**プロパティ**] をクリックします。[**値**] タブで [**フィールドの選択**] をクリックします。図 9 に示すように、ドロップダウン リストで [**フォルダーのユーザー定義フィールド**] をポイントして [**Frequent Flyer Number**] をクリックし、[**OK**] をクリックします。![図 9。Frequent Flyer Number フィールドをテキスト ボックス コントロールにバインドします。](81342ca4-f75f-7601-5915-0174cd77860c.md)

11. チェック ボックス コントロールを追加して、Vegetarian フィールドをチェック ボックス コントロールにバインドします。
    1. 図 10 に示すように、チェック ボックス コントロールをピック アンド クリックして、ツールボックスからフォーム領域に追加します。
    2. 図 10 に示すように、チェック ボックス コントロールを右クリックして、[**プロパティ**] をクリックします。[**表示**] タブで**キャプション**として **Vegetarian?** と入力します。 ![図 10。チェック ボックス コントロールのキャプションを指定します。](375c2c33-1a71-0fc4-0ab6-62bfdf4e80e9.md)
    3. [**値**] タブをクリックして、[**フィールドの選択**] をクリックします。図 11 に示すように、ドロップダウン リストの [**フォルダーのユーザー定義フィールド**] をポイントして、[**Vegetarian**] をクリックします。次に [**OK**] をクリックします。 ![図 11。Vegetarian フィールドをチェック ボックス コントロールにバインドします。](6edba9e7-90bc-5500-d487-5cc91a218675.md)

12. ラベル コントロールとコンボ ボックス コントロールを追加して、Seat Preference フィールドをコンボ ボックス コントロールにバインドします。
    1. 図 12 に示すように、ラベル コントロールをピック アンド クリックして、ツールボックスからフォーム領域に追加します。
    2. ラベル コントロールを右クリックして、[**プロパティ**] をクリックします。[**表示**] タブで[**キャプション**]として [**Seat Preference:**] と入力します。[**OK**] をクリックします。
    3. 図 12 で示すように、コンボ ボックス コントロールをピック アンド クリックして、ツールボックスからフォーム領域に追加します。
    4. コンボ ボックス コントロールを右クリックして、[**プロパティ**] をクリックします。[**値**] タブで、[**フィールドの選択**] をクリックします。図 12 に示すように、ドロップダウン リストで [**フォルダーのユーザー定義フィールド**] をポイントし、[**Seat Preference**] をクリックします。 ![図 12。Seat Preference フィールドをコンボ ボックス コントロールにバインドします。](89e3a7b1-f930-7aa9-1b48-a42f7057afa9.md)
    5. ドロップダウン リストの値を定義するには、[**使用できる値**] として [**Aisle,Center,Window**] と入力します。 
    6. [**このフィールドに初期値を設定する:**] のチェックをオンにして、隣のテキスト ボックスに表示の初期値として [**Aisle**] と入力します。次に [**OK**] をクリックします。

13. コントロールをフォーム領域上に配置します。
    1. Shift キーを押しながら、[**Contoso Airlines**]、[**Frequent Flyer Number**]、および [**Seat Preference:**] の 3 つのラベル コントロールを選択します。
    2. 右クリックして [**配置**] をポイントし、[**左揃え**] を選択します。これにより、選択したコントロールの左端が揃います。
    3. Shift キーを押しながら、テキスト ボックス コントロールとコンボ ボックス コントロールを選択します。
    4. 右クリックして [**配置**] をポイントし、[**左揃え**] を選択します。
    5. Shift キーを押しながら、[**Frequent Flyer Number**] のラベル コントロール、テキスト ボックス コントロール、およびチェック ボックス コントロールを選択します。
    6. 右クリックして [**配置**] をポイントし、[**下揃え**] を選択します。これにより、選択したコントロールが下端で揃えられます。
    7. Shift キーを押しながら、[**Seat Preference:**] のラベル コントロールとコンボ ボックス コントロールを選択します。
    8. 右クリックして [**配置**] をポイントし、[**下揃え**] を選択します。

14. [**フォーム領域**] をクリックし、[**フォーム領域に名前を付けて保存**] をクリックします。フォルダー **Form Regions** を c: ドライブに作成し、ファイル名として **Contoso** と入力し、[**保存**] をクリックします。
15. [**変更を保存しますか?**] と尋ねられるので、[**いいえ**] をクリックします。




フォーム領域マニフェスト XML ファイルの作成



メモ帳などの XML エディターを使用して、フォーム領域マニフェスト XML ファイル Contoso.xml をフォルダー c:\Form Regions 内に作成し、次の行を入力します。 

```visualbasicandcsharp
<?xml version="1.0"?> 
<FormRegion xmlns="http://schemas.microsoft.com/office/outlook/12/formregion.xsd"> 
    <!-- Internal name --> 
    <name>ContosoAdjoining</name> 
    <!-- Display name --> 
    <title>Contoso Airlines</title> 
    <!--  Additive adjoining form region --> 
    <formRegionType>adjoining</formRegionType> 
    <!--  Outlook form region file is in the current folder relative to the location of contoso.xml --> 
    <layoutFile>Contoso.ofs</layoutFile> 
    <!-- Display form region when inspector is in the Reading Pane --> 
    <showPreview>true</showPreview> 
    <!-- Version of form region --> 
    <version>1.0</version> 
</FormRegion> 

```




フォーム領域の登録



フォーム領域を実際に使うためには、メッセージ クラスその他、Outlook で表示するために必要な情報を、Windows レジストリに登録する必要があります。コントロールのフォーム領域は連絡先アイテムの表示に使うものなので、現在のユーザー キー以下、**HKEY_CURRENT_USER\Software\Microsoft\Office\Outlook\FormRegions\IPM.Contact** に登録します。

1. Outlook を終了します。
2. キー **HKEY_CURRENT_USER\Software\Microsoft\Office\Outlook\FormRegions** がレジストリになければ追加します。
3. **FormRegions** キー以下に **IPM.Contact** というキーがなければ追加します。
4. **IPM.Contact** キーに対し、文字列型 (**String**) の値を追加し、名前として [**ContosoAdjoining**]、データとして [**c:\Form Regions\contoso.xml**] を指定します。
5. レジストリを閉じます。




フォーム領域の使い方

1. Outlook を起動します。
2. 連絡先アイテムを開きます。




図 1 のように、連絡先フォームの [**全般**] ページの末尾に、フォーム領域 [**Contoso 航空**] が表示されているはずです。


