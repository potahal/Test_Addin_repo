
# SignatureProvider.VerifyXmlDsig ???? (Office)

????????????????????????????????????????????????


## ??

 _?_. **VerifyXmlDsig**( ** _QueryContinue_**, ** _psigsetup_**, ** _psiginfo_**, ** _XmlDsigStream_**, ** _pcontverres_**, ** _pcertverres_** )

 _?_ **SignatureProvider** ???????????????????????


### ??????



|**??**|**??/?????**|**????**|**??**|
|:-----|:-----|:-----|:-----|
| _QueryContinue_|??|**IQueryContinue**|??? ?????????????????????????????????????????????|
| _psigsetup_|??|**SignatureSetup**|??????????????????|
| _psiginfo_|??|**SignatureInfo**|??????????????????|
| _XmlDsigStream_|??|**IStream**|**XMLDSIG** ????????? XML ??????????????????|
| _pcontverres_|??|**ContentVerificationResults**|???????????????????????|
| _pcertverres_|??|**CertificateVerificationResults**|??????????????????????|

## ??

XMLDSIG ???????????? (http://www.w3.org/TR/xmldsig-core/) ????? ???????????????????Microsoft Office ????????????


## ?

C# ??????????????????????? ??????? **VerifyXmlDsig** ?????????????


```
 public void VerifyXmlDsig(object queryContinue, SignatureSetup sigsetup, SignatureInfo siginfo, object xmldsigStream, ref ContentVerificationResults contverresults, ref CertificateVerificationResults certverresults) 
 { 
 using (COMStream comstream = new COMStream(xmldsigStream)) 
 { 
 XmlDocument xmldsig = new XmlDocument(); 
 xmldsig.PreserveWhitespace = true; 
 xmldsig.Load(comstream); 
 
 XmlElement signature = xmldsig.DocumentElement; 
 SignedXml signedXml = new SignedXml(); 
 signedXml.LoadXml(signature); 
 
 contverresults = signedXml.CheckSignature() ? 
 Microsoft.Office.Core.ContentVerificationResults.contverresValid : 
 Microsoft.Office.Core.ContentVerificationResults.contverresModified; 
 } 
 }
```


 **??**  ??????????????? ???????????? ???????????? COM ????????????Microsoft® Visual Basic® for Applications (VBA) ??????????


## ????


#### ??


[SignatureProvider ??????](3df5d1dc-f7da-dacc-239a-7b02f79a5d1b.md)
#### ????????


[SignatureProvider ???????????](http://msdn.microsoft.com/library/8f99b46b-ee6c-54eb-570a-d2b34c0a8b3d%28Office.15%29.aspx)