

---
ms.Toctitle:カスタム プロパティ ページの追加
title:カスタム プロパティ ページの追加
ms.ContentId:45390e9b-438c-86b0-488c-b179cabe4276
---
# カスタム プロパティ ページの追加





          UNRESOLVED_TOKEN_VAL(outlooknv1) でのカスタム プロパティ ページの作成には、主に次の 4 つの手順があります。

1. ページを ActiveX コントロールとして作成します。
2. [PropertyPage](22e561d5-603e-2cf3-e142-6173dd0d4c25.md)オブジェクトを実装します。
3. [Dirty](fb654f40-9b80-654c-395a-811923dfb903)プロパティの値を設定し、 [OnStatusChange](d314f8fc-33f5-0a6f-22c0-e26548e21a4f.md)メソッドを呼び出すプロシージャを記述します。
4. **OptionsPagesAdd**の必要に応じて、[アプリケーション](797003e7-ecd1-eccb-eaaf-32d6ddde8348)または[名前空間](f0dcaa19-07f5-5d42-a3bf-2e42b7885644)のいずれかのオブジェクトのイベント プロシージャを含むコンポーネント オブジェクト モデル (COM) アドインを作成します。COM アドインを作成する方法の詳細については、[カスタマイズする Outlook の COM アドインを使用する](84a4f616-3ace-0139-57d5-f0c070064ab2.md)を参照してください。


## ページを ActiveX コントロールとして作成する
Outlook のカスタム プロパティ ページは、ActiveX コントロールであり、COM アドインとして設計されたダイナミック リンク ライブラリ (DLL) と共に実装されます。カスタム プロパティ ページを作成する最も簡単な方法は、Microsoft Visual Basic Version 6.0 以降を使用することです。このバージョンの Visual Basic では、ActiveX コントロールおよび COM アドインの作成プロセスが単純化されたテンプレートおよびツールが提供されています。



ActiveX コントロールの作成時に、ユーザーがプロパティ (ページでサポートするプロパティ) の設定を要求するコントロールをその ActiveX コントロールに配置します。Outlook がプロパティ ページをダイアログ ボックスに表示するときに、コントロールのサイズを変更する可能性があるため、コントロールの **Width** および **Height** プロパティの最終的な値に応じて、コントロールの **Initialize** イベントを使って子コントロールを動的に配置し、サイズを変更する必要があります。



カスタム プロパティ ページが表示されるダイアログ ボックスには、プロパティ ページの下に [**OK**] ボタン、[**キャンセル**] ボタン、[**適用**] ボタンの 3 つのボタンがあります。ユーザーが [**OK**] ボタンをクリックすると、ダイアログ ボックスのすべてのページでのプロパティの変更が適用され、ダイアログ ボックスが閉じます。[**キャンセル**] ボタンをクリックすると、プロパティは変更されずにダイアログ ボックスが閉じます。[**適用**] ボタンをクリックすると、プロパティの変更はすべて適用されますが、ダイアログ ボックスは開いたままです。ユーザーがこれらのボタンをクリックしたときに、適切に応答するようにプロパティ ページを設計する必要があります。プロパティ ページの変更の状態を Outlook に通知する方法、および変更されたプロパティの値が適用されたときに Outlook がプログラムに通知する方法については、このトピックの後の方で説明します。



## PropertyPage オブジェクトを実装する
**PropertyPage** オブジェクトは抽象的なオブジェクトです。つまり、インターフェイスは定義できますが、Outlook では実装されません。カスタム プロパティの変更が、ダイアログ ボックスの [**適用**] ボタンまたは [**ヘルプ**] ボタンに依存する場合、カスタム プロパティ ページの ActiveX コントロールを含むモジュールには、**PropertyPage** オブジェクトを実装する必要があります。このオブジェクトを実装するには、モジュールで Outlook オブジェクト ライブラリへの参照が行われ、次のステートメントが記述されている必要があります。

```sourcecode
Implements Outlook.PropertyPage
```




また、このモジュールには **PropertyPage** オブジェクトのメソッドとプロパティを実装するコードが記述されている必要があります。次の表は、これらのプロシージャの一覧です。

|**プロシージャ**|**説明**|
|---|---|
|**Dirty**プロパティ|ユーザーがプロパティ ページで値を変更するかどうかを判断するのには、 **OnStatusChange**メソッドへの応答では、Outlook によって呼び出されます。|
|[Apply](fdb35048-2471-4402-8137-c75994680b3c.md)
 メソッド|ユーザーが [**OK**] または [**適用**] ボタンをクリックしたことをプログラムに通知するために、Outlook によって呼び出されます。通常、このプロシージャはユーザーがプロパティ ページで変更したプロパティの値を適用します。|
|[GetPageInfo](39243864-a81a-eaa6-965d-c1a5ac5ac781.md)
 メソッド|このプロパティ ページに関連付けられているヘルプ ファイルとトピックを取得するために Outlook によって呼び出されます。|



## Dirty プロパティの値を設定し、OnStatusChange メソッドを呼び出すプロシージャを記述する
一般に、プロパティの値の変更は、ユーザーとユーザーが値を指定するコントロールとのやり取りに応答してすぐに適用されるわけではありません。その代わり、ユーザーがダイアログ ボックスの [**OK**] または [**適用**] をクリックしたときに、値は適用されます。[**適用**] ボタンは、プロパティ ページでユーザーが値を変更するまで淡色表示になっています。ユーザーがプロパティ ページで値を変更したことを Outlook に通知するには、プログラムで **OnStatusChange** メソッドを呼び出し、Outlook が Dirty プロパティを照会したときに True を返す必要があります。



## OptionsPagesAdd イベントのイベント プロシージャを含む COM アドインを作成する
**OptionsPagesAdd**イベントでは、プログラムに、(**名前空間**オブジェクトに対してイベントが呼び出された) 場合、 UNRESOLVED_TOKEN_VAL(outlooknv1)**オプション**] ダイアログ ボックス ( **Application**オブジェクトのイベントが発生) の場合、またはフォルダーの**プロパティ**] ダイアログ ボックスに、カスタム プロパティ ページを追加する機会が与えられます。Outlook では、このイベント プロシージャを呼び出す、ときに、[プロパティ ページ](9850ae7b-f167-d3b2-2e9b-f1df1e4922ec)オブジェクトを渡します。ユーザーのイベント プロシージャは、オブジェクトをプログラムによって実装された**PropertyPage**オブジェクトを追加するのには、コレクションの[Add](85fd8b5e-7236-4cae-6d2d-5ff940ceb6a1.md)メソッドを使用します。




