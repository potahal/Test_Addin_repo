
# MailItem.GetConversation ???? (Outlook)(????)

????????????????????  **[Conversation](2705d38a-ebc0-e5a7-208b-ffe1f5446b1b.md)** ?????????????


## ??

 _?_. **GetConversation**

 _?_ **[MailItem](14197346-05d2-0250-fa4c-4a6b07daf25f.md)** ??????????????????


### ???

 **??** ?????????????????????????


## ??

 **GetConversation** ???????????????? **Null** ( **Nothing** ? Visual Basic) ???????????????????????????


- ??????????????? ?????????????????????????????????????????
    
- ????????? (??? ?????????????????????) ??????????
    
- Windows ????????????????????????
    
- ???????? ?????????????? (?????Microsoft Exchange Server 2010 ?????????? Microsoft Exchange ?????Outlook ????????? ???????????)????????? ????????????????????????? **[Store](1eb22fe9-8849-7476-5388-2515b48591b9.md)** ??????? **[IsConversationEnabled](ce333881-a5f3-2115-0ae4-296d15c4bead.md)** ????????????
    



## ?

?????? ???? C# ????????????????? ?????? ??? (COM) ?????????? .NET Framework ???? ??? ???????????????? ??????????????????? ??? ??? ?????? COM ????????????????????????????????????Outlook ????Visual Studio ??? Outlook ???????????????? (PIA) ????????Outlook 2013 ?????? ??? ????????????Outlook 2013 PIA ????????????Visual Studio ? Microsoft Outlook 15.0 ?????? ????? ??????????????????????????????Outlook ?????  `ThisAddIn` ??????????????? (Visual Studio ? Office Developer Tools ???)????? **Application** ??????? `ThisAddIn.Globals` ??????????? Outlook **Application** ?????????????????Outlook PIA ????????? Outlook ???????????????????MSDN ?? **Outlook ???????????????? ???????????**???????????

????????????? ???? ????????????????? ??????????????????????????????? ??????????????????????????????????????????????????? `DemoConversation`??????? **??** ??????????????????????????? ????? **GetConversation** ???????????? `DemoConversation`?????? **[????](0affaafd-93fe-227a-acee-e09a86cadc20.md)** ???????? **[SimpleItems](b929ae28-fe5f-607e-37b5-ed6a304d4896.md)** ??????????? **????** ??????? **[GetTable](6c5a4ef5-c31d-6684-722a-f6f3b3fe6b55.md)** ? **[GetRootItems](72c4d9fd-4f38-d081-7dc6-e9dbfad6d3aa.md)** ???????????? `DemoConversation`????????????????????????????????? `EnumerateConversation`????????




```C#
void DemoConversation() 
{ 
 object selectedItem = 
 Application.ActiveExplorer().Selection[1]; 
 // This example uses only 
 // MailItem. Other item types such as 
 // MeetingItem and PostItem can participate 
 // in the conversation. 
 if (selectedItem is Outlook.MailItem) 
 { 
 // Cast selectedItem to MailItem. 
 Outlook.MailItem mailItem = 
 selectedItem as Outlook.MailItem; 
 // Determine the store of the mail item. 
 Outlook.Folder folder = mailItem.Parent 
 as Outlook.Folder; 
 Outlook.Store store = folder.Store; 
 if (store.IsConversationEnabled == true) 
 { 
 // Obtain a Conversation object. 
 Outlook.Conversation conv = 
 mailItem.GetConversation(); 
 // Check for null Conversation. 
 if (conv != null) 
 { 
 // Obtain Table that contains rows 
 // for each item in the conversation. 
 Outlook.Table table = conv.GetTable(); 
 Debug.WriteLine("Conversation Items Count: " + 
 table.GetRowCount().ToString()); 
 Debug.WriteLine("Conversation Items from Table:"); 
 while (!table.EndOfTable) 
 { 
 Outlook.Row nextRow = table.GetNextRow(); 
 Debug.WriteLine(nextRow["Subject"] 
 + " Modified: " 
 + nextRow["LastModificationTime"]); 
 } 
 Debug.WriteLine("Conversation Items from Root:"); 
 // Obtain root items and enumerate the conversation. 
 Outlook.SimpleItems simpleItems 
 = conv.GetRootItems(); 
 foreach (object item in simpleItems) 
 { 
 // In this example, enumerate only MailItem type. 
 // Other types such as PostItem or MeetingItem 
 // can appear in the conversation. 
 if (item is Outlook.MailItem) 
 { 
 Outlook.MailItem mail = item 
 as Outlook.MailItem; 
 Outlook.Folder inFolder = 
 mail.Parent as Outlook.Folder; 
 string msg = mail.Subject 
 + " in folder " + inFolder.Name; 
 Debug.WriteLine(msg); 
 } 
 // Call EnumerateConversation 
 // to access child nodes of root items. 
 EnumerateConversation(item, conv); 
 } 
 } 
 } 
 } 
} 
 
 
void EnumerateConversation(object item, 
 Outlook.Conversation conversation) 
{ 
 Outlook.SimpleItems items = 
 conversation.GetChildren(item); 
 if (items.Count > 0) 
 { 
 foreach (object myItem in items) 
 { 
 // In this example, enumerate only MailItem type. 
 // Other types such as PostItem or MeetingItem 
 // can appear in the conversation. 
 if (myItem is Outlook.MailItem) 
 { 
 Outlook.MailItem mailItem = 
 myItem as Outlook.MailItem; 
 Outlook.Folder inFolder = 
 mailItem.Parent as Outlook.Folder; 
 string msg = mailItem.Subject 
 + " in folder " + inFolder.Name; 
 Debug.WriteLine(msg); 
 } 
 // Continue recursion. 
 EnumerateConversation(myItem, conversation); 
 } 
 } 
} 
 

```


## ????


#### ??


[MailItem ??????](14197346-05d2-0250-fa4c-4a6b07daf25f.md)
#### ????????


[MailItem ???????????](http://msdn.microsoft.com/library/1094d7df-ee80-a4b0-5a21-db2979506e6b%28Office.15%29.aspx)