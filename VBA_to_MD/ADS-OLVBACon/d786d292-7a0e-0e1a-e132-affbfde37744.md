

---
ms.Toctitle:フォルダー内のアイテムの列挙、検索、フィルター
title:フォルダー内のアイテムの列挙、検索、フィルター
ms.ContentId:d786d292-7a0e-0e1a-e132-affbfde37744
---
# フォルダー内のアイテムの列挙、検索、フィルター




Outlook オブジェクト モデルには、フォルダー内のアイテムの列挙、検索、およびフィルターをサポートするいくつかのエントリ ポイントが用意されています。

## アイテムの列挙
**Items** オブジェクト、**Table** オブジェクト、および **Selection** オブジェクトは、いずれもフォルダー内のアイテムの列挙をサポートしています。ただし、特定のシナリオによっては、これらのオブジェクトから最適なオブジェクトを選択することが必要な場合もあります。



フォルダー内のアイテムを返す **Folder.Items** を呼び出すと、**Items** コレクションを取得できます。コレクション内の各アイテム オブジェクトには、明示的に組み込まれているプロパティとカスタム プロパティのすべてが設定され、読み書き操作がサポートされます。**Items** コレクションは、フィルターとイベントもサポートしています。イベントは、アイテムが追加または変更されたり、コレクションから削除されたときに発生します。



**マッチング**または**これら**を使用するには、フォルダーまたは検索フォルダー内の項目のセットを表す**Table**オブジェクトを取得します。どちらの場合も、フォルダー内のアイテムのサブセットを取得するためのフィルターを指定したり、任意のフィルターを指定しない場合は、フォルダー内のすべてのアイテムを取得できます。既定では、返される**テーブル**内の各項目には、そのプロパティの既定のサブセットのみが含まれています。**テーブル**の各行を表示するには、フォルダー、アイテムのプロパティとしては、各列内の項目として、**テーブル**のフォルダー内のアイテムの高速な列挙とフィルターでは、メモリ内の軽量な行セットです。基になるフォルダーの追加と削除は、**テーブル**内の行に反映されますが、**テーブル**では、追加、変更、および削除する行は、すべてのイベントはできません。オブジェクトは、**テーブル**の行が必要な場合は、既定の**テーブル**内の列のエントリ Id からその行のエントリ ID を取得して、完全なアイテムを取得するのには、**名前空間**オブジェクトの**GetItemFromID**メソッドを使用して、 **MailItem****ContactItem**など、読み取り/書き込み操作をサポートします。

**テーブル**の既定の列の詳細については、 [Table オブジェクトに表示される既定のプロパティ](649c64f3-2d1e-23f1-bf13-3368da79e62b.md)を参照してください。



**Selection** オブジェクトは、エクスプローラーで現在選択されているアイテムの列挙をサポートしています。**Selection** オブジェクトでは、エクスプローラーにフォルダーの内容が表示された後、そのフォルダー内のアイテムをユーザーの選択に従って列挙できます。

>[!NOTE]
>Outlook のフォルダーには、さまざまな種類のアイテムを格納できます。たとえば連絡先フォルダーでは、連絡先アイテムと配布リスト アイテムの作成が既定でサポートされています。**Items** オブジェクト、**Table** オブジェクト、および **Selection** オブジェクトは、フォルダーまたは検索フォルダーのアイテムをカプセル化するものであるため、これらのオブジェクト内の各アイテムは、必ずしも同一のメッセージ クラスに属するとは限りません。これらのコレクションやオブジェクトに含まれるアイテムを列挙するときは、アイテムのプロパティにアクセスする前に、まず各アイテムのメッセージ クラスを確認することをお勧めします。





## アイテムの検索およびフィルター
**Items** オブジェクト、**Table** オブジェクト、**Application** オブジェクト、および **View** オブジェクトは、フォルダー内のアイテムの検索とフィルターをサポートしています。次の表は、これらのエントリ ポイントについて説明し、比較したものです。





|||||||
|---|---|---|---|---|---|
|**エントリ ポイント**|**動作**|**検索フィルターのオブジェクト**|**Jet フィルターのサポート**|**DASL フィルターのサポート**|**コメント**|
|**Application.AdvancedSearch**|**Search** オブジェクトの条件を設定し、その **Search** オブジェクトを返します。検索結果は **Search.Results** に設定されます。**Search.Save** は、検索結果を使用して検索フォルダーを更新します。|フォルダー|なし|あり||
|**Folder.GetTable**|指定されたフィルターに基づいて、フォルダー内のアイテムの **Table** を返します。|フォルダー|あり|あり|バイナリ プロパティ、HTML 形式または RTF 形式の本文の内容など、特定のプロパティは **Table** フィルターでサポートされていません。詳細については、「[Table オブジェクトまたは Table フィルターのサポートされていないプロパティ](0e37f03f-7677-ca29-d0b2-8b45c026e5f1.md)」を参照してください。|
|**Items.Find**|指定されたフィルターに一致する最初のアイテムを検索します。|フォルダー|あり|なし|**Body** など、特定のプロパティはフィルターでサポートされていません。詳細については、**Items.Find** を参照してください。|
|**Items.Restrict**|指定された制限に基づいて現在のアイテムのセットにフィルターをかけ、新しい **Items** コレクションを返します。|フォルダー|あり|あり|**Body** など、特定のプロパティはフィルターでサポートされていません。詳細については、**Items.Restrict** を参照してください。|
|**Search.GetTable**|**Application.AdvancedSearch** から派生した任意のフィルターに基づいて、検索フォルダー内のアイテムの **Table** を返します。|検索フォルダー|なし|あり|**Search.GetTable** は、**Application.AdvancedSearch** から返された **Search** オブジェクト (具体的には **Search.Filter** プロパティ) からフィルターを派生します。|
|**Table.Restrict**|指定されたフィルターに基づいて現在のテーブルの行にフィルターをかけ、新しい **Table** オブジェクトを返します。|フォルダー|あり|あり|バイナリ プロパティ、HTML 形式または RTF 形式の本文の内容など、特定のプロパティは **Table** フィルターでサポートされていません。詳細については、「[Table オブジェクトまたは Table フィルターのサポートされていないプロパティ](0e37f03f-7677-ca29-d0b2-8b45c026e5f1.md)」を参照してください。|
|**View.Filter**|ビューの XML を変更せずに、ビューのフィルターを設定します。ビューのフィルターを設定しても、ユーザー インターフェイスのビューが変更されるだけで、**Items** コレクションにフィルターが適用されるわけではありません。|フォルダー|なし|あり||
|**View.XML**|ビューの XML を取得または設定します。<Filter> ノードを変更すると、ビューのフィルターが変更されます。ビューの XML を設定しても、ユーザー インターフェイスのビューが変更されるだけで、**Items** コレクションにフィルターが適用されるわけではありません。|フォルダー|なし|あり|View XML の使用は適切ではありません。ビューをプログラミングするには、View オブジェクト モデルを使用してください。|








