
# Restrict ????

 **[Items](3a99730b-e62a-5ca6-f6ec-911c95173242.md)** ?????????????????????????????????????????????????????


## ??

 _?_. **Restrict**( ** _Filter_** )

 _?_ **Items** ?????????????????????????


### ??????


|
|

### ???

 **Items** ???????????????????? **Items** ???????????????????????


## ??

??????????????????????????? **[Find](e7a791d8-b80b-df07-84a3-a85acabfcf80.md)** ???????? **[FindNext](2530f640-e024-3567-f539-6bdbf645401d.md)** ???????????????????????????????????????????? **Find** ????? **FindNext** ?????????????????????????????????????????????????????????????????????????????????? **Restrict** ?????????????????


 **??**   **Find** ???? **Restrict** ????????????????????????????????????????????????????????????????????????????????????????????????????????????[ **????????**] ????? ?????????[ **???????**] ?????????

?????????????????????????????????????


|
|

### Find ??????? Restrict ???????????????

??????????????????????????????????????


### ???? (String) (???? ????????)

???? ??????????????????????????????????????????? (') ???????? (") ?????????????????????????? ( **String**) ????????????????????

 `sFilter = "[CompanyName] = 'Microsoft'"`

 `sFilter = "[CompanyName] = ""Microsoft"""`

 `sFilter = "[CompanyName] = " &amp; Chr(34) &amp; "Microsoft" &amp; Chr(34)`

Jet ?????? DASL ???????????????????????????????????????????????????????? (??????????) ????????????????? (??????????) ??????????????????? 1 ????????????????????????????????????????????????????????????????????????????? 1 ??????? 

???????  `can't` ???? **Subject** ??????????????? DASL ??????????????????????????????????????????????? `can't` ???????????????????????????????????????????? 3 ?????????? `http://schemas.microsoft.com/mapi/proptag/0x0037001f` ??????????????????????????????? `can't` ???????????????????????????????????????????????????????????????

 `filter = "@SQL=""http://schemas.microsoft.com/mapi/proptag/0x0037001f"" = 'can''t'"`

???????????????????????????? (ASCII ????? 34) ???  `chr(34)` ????????????????????????????????? `chr(34)` ???????????????????????????

 `filter = "@SQL= " &amp; Chr(34) &amp; "http://schemas.microsoft.com/mapi/proptag/0x0037001f" _`

 `&amp; Chr(34) &amp; " = " &amp; "'can''t'"`

????????????????????? **ci_startswith** ?????? **ci_phrasematch** ???????? DASL ???????????????????????????????? `can't` ??????????????????

 `filter = "@SQL=" &amp; Chr(34) &amp; "http://schemas.microsoft.com/mapi/proptag/0x0037001E" _`

 `&amp; Chr(34) &amp; " ci_phrasematch " &amp; "'can''t'"`

?? 1 ?????????  `the right stuff` ???? **Subject** ??????????????? DASL ??????????????????????? `stuff` ?????????????????????????????????????????????????

 `filter = "@SQL=""http://schemas.microsoft.com/mapi/proptag/0x0037001f"" = 'the right ""stuff""'"`

??????????????????????????????????????????????????????????????????????????????????????????????????????????????? URL (Universal Resource Locator) ??????????????????


|
|
???????  `pearls` ?????????? ????? **Mom's "Gift"** ??????????????????????

 `filter = "@SQL=" &amp; Chr(34) &amp; _`

 `"http://schemas.microsoft.com/mapi/string/{00020329-0000-0000-C000-000000000046}/" _`

 `&amp; "Mom%27s%20%22Gift%22" &amp; Chr(34) &amp; " like '%pearls%'"`


### ??? (Date)

???????????????????????? **Find** ??????? **Restrict** ????????????????????????????????????? Microsoft Outlook ?????????????? **Format** ??????????????1999 ? 1 ? 15 ??? 3 ? 30 ????????????????????????????????????

 `sFilter = "[LastModificationTime] > '" &amp; Format("1/15/99 3:30pm", "ddddd h:nn AMPM") &amp; "'"`


### ???? (Boolean)

TRUE/FALSE?YES/NO?ON/OFF ??????? (Boolean) ???????????????????????????????????????????????????????????????????????

 `sFilter = "[Journal] = True"`


 **??**  ???? ( **Boolean**) ??????????????????????????????????????  **False** ?????????????????????????????????????????????????????? **True** ??????????????????????????


### ????? (????)

" **????**" ???????????????????????????????????????? " **????**" ???????????????????????????? ??????????????????????????????????????????????????????????????????????? ????????????????????????????????????  **Find** ??????? **Restrict** ????????????????????????"??" ???????????????"??" ????? "????" ????????????????????????????? **Find** ????? **Restrict** ????? "??" ?????????????????????????????????????????????????????????????????? ?????????? "??" ?????????????????? **Instr** ?????????????


 **??**  ????????????"????" ?????????? 2 ????????????????????????? **Find** ??????? **Restrict** ????? OR ???????????"??" ?????????????????????????????"??" OR "??, ???" OR "???, ??"????????????????????????????????????????????????????????


### ??

??? ( **Integer**) ????????????????????????????????????????Outlook 2000 ?????????????????????

 `sFilter = "[OutlookInternalVersion] = 92711"`

 `sFilter = "[OutlookInternalVersion] = '92711'"`


### ?????????????

 **Restrict** ?????????????????????????????????????????? Microsoft Visual Basic Scripting Edition (VBScript) ????????????????????????????

 `sFullName = "Dan Wilson"`

 `' This approach uses Chr(34) to delimit the value.`

 `sFilter = "[FullName] = " &amp; Chr(34) &amp; sFullName &amp; Chr(34)`

 `' This approach uses double quotation marks to delimit the value.`

 `sFilter = "[FullName] = """ &amp; sFullName &amp; """"`


### ????????????????

????????????AND?OR???? NOT ??? **Restrict** ???????????????????????????????????????????????????

OR: "??" ??????? "???" ??????????????????????????????

 `sFilter = "[Categories] = 'Personal' Or [Categories] = 'Business'"`

AND: Microsoft ???????????????????????

 `sFilter = "[Categories] = 'Personal' And [CompanyName] = 'Microsoft'"`

NOT: Microsoft ????????????????????????

 `sFilter = "[Categories] = 'Personal' And Not([CompanyName] = 'Microsoft')"`


### ????

 **Find** ??????? **Restrict** ????????????????????????????????????????????????????????????????????????????????"???" ?????????????????????????????? **Find** ??? **Restrict** ??????[ **??**] ??????????????????????????????????????? **[AdvancedSearch](7b433d8b-08b9-dff1-b854-287d76b47a90.md)** ?????????????????????????????????????????? **InStr** ???????????????????????? **Restrict** ??????????????????????????????????????????????? M ?????????????????????????????

 `sFilter = "[LastName] > 'LZZZ' And [LastName] < 'N'"`


## ?

???? Visual Basic for Applications (VBA) ?????? **Restrict** ????????????????? " **??**" ???????????????????????? " **??**" ???????????????????????????????????"??" ????????????????????????????????????????????????????????


```
Sub MoveItems()
    Dim myNamespace As Outlook.NameSpace
    Dim myFolder As Outlook.Folder
    Dim myItems As Outlook.Items
    Dim myRestrictItems As Outlook.Items
    Dim myItem As Outlook.MailItem

    Set myNamespace = Application.GetNamespace("MAPI")
    Set myFolder = _
        myNamespace.GetDefaultFolder(olFolderInbox)
    Set myItems = myFolder.Items
    Set myRestrictItems = myItems.Restrict("[Categories] = 'Business'")
    For i =  myRestrictItems.Count To 1 Step -1
        myRestrictItems(i).Move myFolder.Folders("Business")
    Next
End Sub
```


## ?

???? Visual Basic for Applications ?????? **Restrict** ????????????????? **[LastModificationTime](14962429-bbf6-a814-647a-70be1dad339d.md)** ????????????????????????


```
Public Sub ContactDateCheck()
    Dim myNamespace As Outlook.NameSpace
    Dim myContacts As Outlook.Items
    Dim myItems As Outlook.Items
    Dim myItem As Object
    
    Set myNamespace = Application.GetNamespace("MAPI")
    Set myContacts = myNamespace.GetDefaultFolder(olFolderContacts).Items
    Set myItems = myContacts.Restrict("[LastModificationTime] > '01/1/2003'")
    For Each myItem In myItems
        If (myItem.Class = olContact) Then
            MsgBox myItem.FullName &amp; ": " &amp; myItem.LastModificationTime
        End If
    Next
End Sub
```


## ?

???? Visual Basic for Applications ????????????????????????????????????????????????????


```
Public Sub ContactDateCheck2()
    Dim myNamespace As Outlook.NameSpace
    Dim myContacts As Outlook.Items
    Dim myItem As Object
    Dim DateStart As Date
    Dim DateToCheck As String
    Dim myRestrictItems As Outlook.Items
	
    Set myNameSpace = Application.GetNamespace("MAPI")
    Set myContacts = myNameSpace.GetDefaultFolder(olFolderContacts).Items
    DateStart = #01/1/2003#
    DateToCheck = "[LastModificationTime] >= """ &amp; DateStart &amp; """"
    Set myRestrictItems = myContacts.Restrict(DateToCheck)
    For Each myItem In myRestrictItems
        If (myItem.Class = olContact) Then
            MsgBox myItem.FullName &amp; ": " &amp; myItem.LastModificationTime
        End If
    Next
End Sub
```

