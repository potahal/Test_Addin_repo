
# Folder.SetCustomIcon ???? (Outlook)(????)

??????  _Picture_ ?????????? ???????????


## ??

 _?_. **SetCustomIcon**( ** _Picture_** )

 _?_ **[Folder](3cf6cda8-6d70-666e-2643-9d9c5b9cacfc.md)** ??????????????????


### ??????



|**??**|**??/?????**|**????**|**??**|
|:-----|:-----|:-----|:-----|
| _Picture_|??|**[IPictureDisp](http://msdn.microsoft.com/en-us/library/ms680762%28VS.85%29.aspx)**|?????????? ???????????|

## ??

 _??_ ??????? **IPictureDisp** ??????? **Type** ?????? **PICTYPE_ICON** ??? **PICTYPE_BITMAP** ?????? ?????????????????????32 x 32 ????????????????????? 16 x 16 ??? 24 x 24 ????????????????/??? (DPI) ???? Outlook ??????????? Microsoft Outlook? 16 x 16 ??????????????????????????????????? **SetCustomIcon** ???????

???????????????????????????????????????? ???????????? ????????????????????????????????? ???????????????  **SetCustomIcon** ??????????


- ???????? ( **[OlDefaultFolders](1a17abd8-09b9-d3e1-2d93-0a4d5580a950.md)** ????????)
    
- ???????? ( **[OlSpecialFolders](31f32a19-9695-3de4-ef3f-fe763a6f878e.md)** ????????)
    
- Exchange ?????? ?????
    
- Exchange ??????????? ?????
    
- ???????
    
 **SetCustomIcon** ??????????????Outlook ???????????????? **IPictureDisp** ?????????????????????? ????????????????????????? **SetCustomIcon** ??????????????????????????????[???????? ?????????????????????????? IPictureDisp ????????????????????](http://support.microsoft.com/kb/150034)??????????

???????????????? ????? ?????????? Outlook ???????????????????????Outlook ????????????????? ????? ?????????????????

???? ????? ????? Outlook Web Access ????? Exchange ???????????????????Windows Mobile ???????????? Outlook ??????????


## ?

?????? ???? C# ????????????????? ?????? ??? (COM) ?????????? .NET Framework ???? ??? ???????????????? ??????????????????? ??? ??? ?????? COM ????????????????????????????????????Outlook ????Visual Studio ??? Outlook ???????????????? (PIA) ????????Outlook 2013 ?????? ??? ????????????Outlook 2013 PIA ????????????Visual Studio ? Microsoft Outlook 15.0 ?????? ????? ??????????????????????????????Outlook ?????  `ThisAddIn` ??????????????? (Visual Studio ? Office Developer Tools ???)????? **Application** ??????? `ThisAddIn.Globals` ??????????? Outlook **Application** ?????????????????Outlook PIA ????????? Outlook ???????????????????MSDN ?? **Outlook ???????????????? ???????????**???????????

?? C# ??????[ **???????**] ???????????????????????????????????????  `PictureDispConverter` ??????????




```C#
//Get the icons for the solution 
stdole.StdPicture rootPict = 
 PictureDispConverter.ToIPictureDisp( 
 Properties.Resources.BRIDGE) 
 as stdole.StdPicture; 
stdole.StdPicture calPict = 
 PictureDispConverter.ToIPictureDisp( 
 Properties.Resources.umbrella) 
 as stdole.StdPicture; 
stdole.StdPicture contactsPict = 
 PictureDispConverter.ToIPictureDisp( 
 Properties.Resources.group) 
 as stdole.StdPicture; 
stdole.StdPicture tasksPict = 
 PictureDispConverter.ToIPictureDisp( 
 Properties.Resources.SUN) 
 as stdole.StdPicture; 
 
//Set the icons for solution folders 
solutionRoot.SetCustomIcon(rootPict); 
solutionCalendar.SetCustomIcon(calPict); 
solutionContacts.SetCustomIcon(contactsPict); 
solutionTasks.SetCustomIcon(tasksPict);
```

 `PictureDispConverter` ??????????????




```C#
using System; 
using System.Drawing; 
using System.Collections.Generic; 
using System.Runtime.InteropServices; 
 
public static class PictureDispConverter 
{ 
 //IPictureDisp GUID. 
 public static Guid iPictureDispGuid = typeof(stdole.IPictureDisp).GUID; 
 
 // Converts an Icon into an IPictureDisp. 
 public static stdole.IPictureDisp ToIPictureDisp(Icon icon) 
 { 
 PICTDESC.Icon pictIcon = new PICTDESC.Icon(icon); 
 return PictureDispConverter.OleCreatePictureIndirect(pictIcon, ref iPictureDispGuid, true); 
 } 
 
 // Converts an image into an IPictureDisp. 
 public static stdole.IPictureDisp ToIPictureDisp(Image image) 
 { 
 Bitmap bitmap = (image is Bitmap) ? (Bitmap)image : new Bitmap(image); 
 PICTDESC.Bitmap pictBit = new PICTDESC.Bitmap(bitmap); 
 return PictureDispConverter.OleCreatePictureIndirect(pictBit, ref iPictureDispGuid, true); 
 } 
 
 
 [DllImport("OleAut32.dll", EntryPoint = "OleCreatePictureIndirect", ExactSpelling = true, 
 PreserveSig = false)] 
 private static extern stdole.IPictureDisp OleCreatePictureIndirect( 
 [MarshalAs(UnmanagedType.AsAny)] object picdesc, ref Guid iid, bool fOwn); 
 
 private readonly static HandleCollector handleCollector = 
 new HandleCollector("Icon handles", 1000); 
 
 // WINFORMS COMMENT: 
 // PICTDESC is a union in native, so we'll just 
 // define different ones for the different types 
 // the "unused" fields are there to make it the right 
 // size, since the struct in native is as big as the biggest 
 // union. 
 private static class PICTDESC 
 { 
 //Picture Types 
 public const short PICTYPE_UNINITIALIZED = -1; 
 public const short PICTYPE_NONE = 0; 
 public const short PICTYPE_BITMAP = 1; 
 public const short PICTYPE_METAFILE = 2; 
 public const short PICTYPE_ICON = 3; 
 public const short PICTYPE_ENHMETAFILE = 4; 
 
 [StructLayout(LayoutKind.Sequential)] 
 public class Icon 
 { 
 internal int cbSizeOfStruct = Marshal.SizeOf(typeof(PICTDESC.Icon)); 
 internal int picType = PICTDESC.PICTYPE_ICON; 
 internal IntPtr hicon = IntPtr.Zero; 
 internal int unused1 = 0; 
 internal int unused2 = 0; 
 
 internal Icon(System.Drawing.Icon icon) 
 { 
 this.hicon = icon.ToBitmap().GetHicon(); 
 } 
 } 
 
 [StructLayout(LayoutKind.Sequential)] 
 public class Bitmap 
 { 
 internal int cbSizeOfStruct = Marshal.SizeOf(typeof(PICTDESC.Bitmap)); 
 internal int picType = PICTDESC.PICTYPE_BITMAP; 
 internal IntPtr hbitmap = IntPtr.Zero; 
 internal IntPtr hpal = IntPtr.Zero; 
 internal int unused = 0; 
 internal Bitmap(System.Drawing.Bitmap bitmap) 
 { 
 this.hbitmap = bitmap.GetHbitmap(); 
 } 
 } 
 } 
} 

```


## ????


#### ??


[????? ??????](3cf6cda8-6d70-666e-2643-9d9c5b9cacfc.md)
#### ????????


[????? ???????????](http://msdn.microsoft.com/library/788acd42-377a-1803-7713-50e45086e2d1%28Office.15%29.aspx)