

---
ms.Toctitle:MailItem.CustomAction イベント (Outlook)(機械翻訳)
title:MailItem.CustomAction イベント (Outlook)(機械翻訳)
ms.ContentId:2068586f-bdab-a786-d933-4e32117bb4f8
---
# MailItem.CustomAction イベント (Outlook)(機械翻訳)




アイテム (親オブジェクトのインスタンス) のカスタム アクションが実行されると発生します。

## 構文

            UNRESOLVED_TOKEN_VAL(offexpression).**CustomAction**(**Action**, **Response**, **Cancel**)




            UNRESOLVED_TOKEN_VAL(offexpression)
            **MailItem** オブジェクトを表す変数を指定します。

### パラメーター

|**名前**|**必須 / オプション**|**データ型**|**説明**|
|---|---|---|---|
|*Action*|
                        UNRESOLVED_TOKEN_VAL(offrequired)
                      |**オブジェクト型 (Object)**|**Action** オブジェクトです。|
|*Response*|
                        UNRESOLVED_TOKEN_VAL(offrequired)
                      |**オブジェクト型 (Object)**|カスタム アクションによって作成される新規アイテムです。|
|*Cancel*|
                        UNRESOLVED_TOKEN_VAL(offrequired)
                      |**ブール型 (Boolean)**|(未使用の vbscript)。**False**イベントが発生します。イベント プロシージャでこの引数に**True**を設定する場合は、カスタム アクションは完了しません。|





## 注釈
**Action**オブジェクトと、カスタム アクションによって新しく作成されたアイテムは、イベントに渡されます。



Microsoft Visual Basic Scripting Edition (VBScript)、この関数の戻り値を**False**に設定すると、カスタム アクションの操作は完了しません。



## 例
この Visual Basic for Applications (VBA) の例では、返信アイテムの**Subject**プロパティを設定するのには、 **CustomAction**イベントを使用します。'リンク元' と呼ばれるカスタム イベントを持つアイテムを作成する`Initialize_Handler`を実行する前に、 `AddAction`プロシージャを実行します。

```vba
Public WithEvents myItem As Outlook.MailItem 
 
 
 
Sub AddAction() 
 
 Dim myAction As Outlook.Action 
 
 
 
 Set myItem = Application.CreateItem(olMailItem) 
 
 Set myAction = myItem.Actions.Add 
 
 myAction.Name = "Link Original" 
 
 myAction.ShowOn = olMenuAndToolbar 
 
 myAction.ReplyStyle = olLinkOriginalItem 
 
 myItem.To = "Dan Wilson" 
 
 myItem.Subject = "Before" 
 
 myItem.Send 
 
End Sub 
 
 
 
Sub Initialize_Handler() 
 
 Set myItem = Application.ActiveInspector.CurrentItem 
 
End Sub 
 
 
 
Private Sub myItem_CustomAction(ByVal Action As Object, ByVal Response As Object, Cancel As Boolean) 
 
 Select Case Action.Name 
 
 Case "Link Original" 
 
 Response.Subject = "Changed by VB Script" 
 
 Case Else 
 
 End Select 
 
End Sub
```




## Related Topics

[MailItem オブジェクトのメンバー](1094d7df-ee80-a4b0-5a21-db2979506e6b.md)

[MailItem オブジェクト](14197346-05d2-0250-fa4c-4a6b07daf25f.md)




