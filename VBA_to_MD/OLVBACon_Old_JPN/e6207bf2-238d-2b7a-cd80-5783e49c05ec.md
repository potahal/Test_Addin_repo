
# ?????????????????????????????????????????

?????????MAPI ????? [PidTagInternetMailOverrideFormat](2fc91e13-703c-3ec9-9066-ffee7144306c.md) ? Microsoft Outlook ?????? ?????????Exchange Internet Mail ???? (IMS) ???????? ????? ???????????? ???????????????????????????????

???????? Visual C# ???MAPI proptag ??????? **PidTagInternetMailOverrideFormat**????????????? ??????????????? MIME ?????????  **[PropertyAccessor ?????? (Outlook)](2fc91e13-703c-3ec9-9066-ffee7144306c.md)** Outlook ?????? ????????????????????????? **PidTagInternetMailOverrideFormat**????????????



```
http://schemas.microsoft.com/mapi/proptag/0x59020003
```

 `0x59020003` ? **PidTagInternetMailOverrideFormat** ? proptag ???



```C#
private void SendMail_Click() 
{ 
    Outlook.NameSpace objSession; 
    Outlook.MailItem objMailItem; 
    Outlook.Recipient objRecipient; 
    Outlook.PropertyAccessor oPA; 
 
    string Recipient, MsgSubject, ImageFile, TextFile, FileLocation, PropName; 
    int EncodingFlag; 
     
 
    //Modify the following to appropriate values. 
    Recipient = "someone@example.com"; 
    EncodingFlag = 1; //Use MIME encoding 
    MsgSubject = "Test Encoding"; 
    ImageFile = "garden.jpg"; 
    TextFile = "mytext.txt"; 
    FileLocation = "c:\\"; 
 
    objSession = Application.GetNamespace("MAPI"); 
    objSession.Logon(null, null, true, null); 
 
    objMailItem = Application.CreateItem( 
                Outlook.OlItemType.olMailItem) as Outlook.MailItem; 
    objMailItem.Subject = MsgSubject; 
    objMailItem.Body = "body"; 
    objMailItem.Attachments.Add(FileLocation + TextFile,  
        Outlook.OlAttachmentType.olByValue, 1, TextFile); 
    objMailItem.Attachments.Add(FileLocation + ImageFile, 
        Outlook.OlAttachmentType.olByValue, 1, ImageFile); 
 
    objRecipient = objMailItem.Recipients.Add(Recipient); 
    objRecipient.Resolve(); 
 
    PropName = "http://schemas.microsoft.com/mapi/proptag/0x59020003"; 
    oPA = objMailItem.PropertyAccessor; 
    oPA.SetProperty(PropName, EncodingFlag); 
 
    objMailItem.Send(); 
 
    objSession.Logoff(); 
 
}

```

