
# ????Outlook ?????????????

?????????Outlook ????????????????  **[Application](797003e7-ecd1-eccb-eaaf-32d6ddde8348.md)** ?????????? (???? ??????????????????????????)??????????????????Outlook ?????????????????????


|||
|:-----|:-----|
|
![](images/MVPLogo_Small_ZA10349011.jpg)

|Helmut Obertanner ???????? ??????????????Helmut ??Microsoft Visual Studio ? Microsoft Office Outlook ?? Microsoft Office ??????????????[????? Professional Microsoft](https://mvp.microsoft.com/en-us/default.aspx
)???|



?????? ??? ????? C# ??? Visual Basic ????????????????? ?????? ??? (COM) ?????????? .NET Framework ???? ??? ???????????????? ??????????????????? ??? ??? ?????? COM ????????????????????????????????????Outlook ????Visual Studio ??? Outlook ???????????????? (PIA) ????????Outlook 2013 ?????? ??? ????????????Outlook 2013 PIA ????????????Visual Studio ? Microsoft Outlook 15.0 ?????? ????? ??????????????????????????????Outlook ?????  `ThisAddIn` ????????? ?????????? (Visual Studio ? Office Developer Tools ???)????? **Application** ??????? `ThisAddIn.Globals` ??????????? Outlook **Application** ?????????????????Outlook PIA ????????? Outlook ???????????????????MSDN ?? **Outlook ???????????????? ???????????**???????????
????? ???????Outlook ???? ?????????????????  `Sample` ???? `GetApplicationObject` ????????????????????? **Microsoft.Office.Interop.Outlook** ???????? Outlook PIA ???????????
 `GetApplicationObject`???? ???????? .NET Fra[]()mework ????????? ?????????????????? Outlook ???????????? ???????????????????? [GetProcessesByName](https://msdn.microsoft.com/library/system.diagnostics.process.getprocessesbyname%28v=vs.110%29.aspx) **Process** ???? **System.Diagnostics** ?????"OUTLOOK"?????????????? ????????????? ?????????????????????????? 1 ?? Outlook ????????????????????? `GetApplicationObject`??Microsoft ??????? (LINQ) ???????[System.Linq](https://msdn.microsoft.com/library/vstudio/system.linq%28v=vs.100%29.aspx)?????[Enumerable](https://msdn.microsoft.com/library/vstudio/system.linq.enumerable%28v=vs.100%29.aspx)?????????????[????](https://msdn.microsoft.com/library/system.linq.enumerable.count%28v=vs.100%29.aspx)??????? [IEnumerable(T)](https://msdn.microsoft.com/library/9eekhta0%28v=vs.100%29.aspx)??????? ???????????????????????[??](https://msdn.microsoft.com/library/system.array%28v=vs.110%29.aspx)?????  **IEnumerable(T)** ?????????????????? `GetApplicationObject`??  **GetProcessesByName** ??????? Outlook ???????????????????????????? **Count** ?????????????????? `GetApplicationObject`?[?????](https://msdn.microsoft.com/library/gg145017%28v=vs.100%29.aspx)?????[???? ??????](https://msdn.microsoft.com/library/vstudio/system.runtime.interopservices.marshal%28v=vs.100%29.aspx)????[????](https://msdn.microsoft.com/library/system.runtime.interopservices.marshal.getactiveobject%28v=vs.100%29.aspx)????????? Outlook ????????????Outlook **????????** ????????????????????????
???? ???????? Outlook ???????????? `GetApplicationObject` ? Outlook ??????????????? **[NameSpace](f0dcaa19-07f5-5d42-a3bf-2e42b7885644.md)** ??????? **[Logon](167c632b-0d52-a1e4-8dcd-57d301cde3c9.md)** ?????????????????????????Outlook ????????????????
????C# ???? ???????



```C#
using System; 
using System.Diagnostics; 
using System.Linq; 
using System.Reflection; 
using System.Runtime.InteropServices; 
using Outlook = Microsoft.Office.Interop.Outlook; 
 
namespace OutlookAddIn1 
{ 
    class Sample 
    { 
        Outlook.Application GetApplicationObject() 
        { 
 
            Outlook.Application application = null; 
 
            // Check if there is an Outlook process running. 
            if (Process.GetProcessesByName("OUTLOOK").Count() > 0) 
            { 
 
                // If so, use the GetActiveObject method to obtain the process and cast it to an Application object. 
                application = Marshal.GetActiveObject("Outlook.Application") as Outlook.Application; 
            } 
            else 
            { 
 
                // If not, create a new instance of Outlook and log on to the default profile. 
                application = new Outlook.Application(); 
                Outlook.NameSpace nameSpace = application.GetNamespace("MAPI"); 
                nameSpace.Logon("", "", Missing.Value, Missing.Value); 
                nameSpace = null; 
            } 
 
            // Return the Outlook Application object. 
            return application; 
        } 
 
    } 
}
```

????Visual Basic ???? ???????



```VB.net
Imports System.Diagnostics 
Imports System.Linq 
Imports System.Reflection 
Imports System.Runtime.InteropServices 
Imports Outlook = Microsoft.Office.Interop.Outlook 
 
Namespace OutlookAddIn2 
    Class Sample 
 
        Function GetApplicationObject() As Outlook.Application 
 
            Dim application As Outlook.Application 
 
            Check if there is an Outlook process running. 
            If Process.GetProcessesByName("OUTLOOK").Count() > 0 Then 
 
                ' If so, use the GetActiveObject method to obtain the process and cast it to an Application object. 
                application = DirectCast(Marshal.GetActiveObject("Outlook.Application"), Outlook.Application) 
            Else 
 
                ' If not, create a new instance of Outlook and log on to the default profile. 
                application = New Outlook.Application() 
                Dim ns As Outlook.NameSpace = application.GetNamespace("MAPI") 
                ns.Logon("", "", Missing.Value, Missing.Value) 
                ns = Nothing 
            End If 
 
            ' Return the Outlook Application object. 
            Return application 
        End Function 
 
    End Class 
End Namespace
```

