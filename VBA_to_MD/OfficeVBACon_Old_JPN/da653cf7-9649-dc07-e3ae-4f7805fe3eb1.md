
# ICTPFactory ?????? (Office)

??????????????????????????


## ?

??????C# ?????????  **CustomTaskPane** ?????????????????????????????? **CTPFactoryAvailable** ??????? **CTPFactoryAvailable** ????????????????????? **CreateCTP** ????????????????????? **ICTPFactory** ?????????????????????????? COM ???????????? **Extensibility.IDTExtensibility2** ???????????????????????SampleActiveX.myControl ??????????????? Microsoft ActiveX 速 ?????????????


```
public class Connect : Object, Extensibility.IDTExtensibility2, ICustomTaskPaneConsumer 
... 
object missing = Type.Missing; 
public CustomTaskPane CTP = null; 
 
public void CTPFactoryAvailable(ICTPFactory CTPFactoryInst) 
{ 
 CTP = CTPFactoryInst.CreateCTP("SampleActiveX.myControl", "Task Pane Example", missing); 
 sampleAX = (myControl)CTP.ContentControl; 
 sampleAX.InsertTextClicked += new InsertTextEventHandler(sampleAX_InsertTextClicked); 
 CTP.Visible = true; 
} 
...
```


 **??**  ?????????????COM ????????????????? ??? ????? (DLL) ?????????????????????????????Microsoft Visual Basic速 6.0?Microsoft Visual Basic .NET?Microsoft Visual C++速?Microsoft Visual C++ .NET?Microsoft Visual C#速 ?????????Microsoft Visual Basic for Applications (VBA) ??????????????????????????


## ????


#### ??


[?????? ??? ??????](499c789a-aba2-0fad-649a-0ea964cd3b5e.md)
#### ????????


[ICTPFactory ???????????](http://msdn.microsoft.com/library/34359a03-163f-40e5-88fe-ba7af0d73a14%28Office.15%29.aspx)