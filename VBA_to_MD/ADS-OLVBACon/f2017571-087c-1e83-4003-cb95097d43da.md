

---
ms.Toctitle:MailItem.GetConversation メソッド (Outlook)(機械翻訳)
title:MailItem.GetConversation メソッド (Outlook)(機械翻訳)
ms.ContentId:f2017571-087c-1e83-4003-cb95097d43da
---
# MailItem.GetConversation メソッド (Outlook)(機械翻訳)




現在のアイテムが属しているスレッドを表す **Conversation** オブジェクトを取得します。

## 構文

            UNRESOLVED_TOKEN_VAL(offexpression).**GetConversation**




            UNRESOLVED_TOKEN_VAL(offexpression)
            **MailItem** オブジェクトを表す変数を指定します。

### 戻り値
**会話**を表すオブジェクトは、この項目が所属する会話です。





## 注釈
**GetConversation**は、項目の会話が存在しない場合は**Null** (**Nothing**で Visual Basic) を返します。次のシナリオ内の項目の会話は存在しません。

- アイテムが保存されていません。

アイテムは、自動保存、ユーザーの操作によって、プログラムを使用して、保存できます。
- 送信可能なアイテム (メール アイテム、予定アイテム、連絡先アイテムなど) が送信されていない。
- Windows レジストリによって、スレッドが無効になっている。
- ストアでスレッド ビューがサポートされていない (たとえば、UNRESOLVED_TOKEN_VAL(ex14long) より前のバージョンの Microsoft Exchange に対して、Outlook が従来のオンライン モードで実行されている)。ストアでスレッド ビューがサポートされているかどうかを判断するには、**Store** オブジェクトの **IsConversationEnabled** プロパティを使用します。








## 例

            UNRESOLVED_TOKEN_VAL(ol14pia_csnote)
          



次のコード例では、エクスプ ローラー ウィンドウで選択した項目は、メール アイテムであると仮定します。コード例では、会話を選択したメール アイテムに関連付けられているし、その会話は、アイテムの件名を表示するのには、各項目の列挙を取得します。`DemoConversation`メソッドでは、**会話**の関連オブジェクトを取得するのには選択されているメール アイテムの**GetConversation**メソッドを呼び出します。`DemoConversation`は、それぞれ**テーブル**オブジェクトと、 **SimpleItems**コレクションを取得する**スレッド**オブジェクトの**GetTable** 、 **GetRootItems**メソッドを呼び出します。`DemoConversation`では、列挙し、その会話の各アイテムの件名を表示する繰り返しメソッド`EnumerateConversation`を呼び出します。

```csharp
void DemoConversation() 
{ 
 object selectedItem = 
 Application.ActiveExplorer().Selection[1]; 
 // This example uses only 
 // MailItem. Other item types such as 
 // MeetingItem and PostItem can participate 
 // in the conversation. 
 if (selectedItem is Outlook.MailItem) 
 { 
 // Cast selectedItem to MailItem. 
 Outlook.MailItem mailItem = 
 selectedItem as Outlook.MailItem; 
 // Determine the store of the mail item. 
 Outlook.Folder folder = mailItem.Parent 
 as Outlook.Folder; 
 Outlook.Store store = folder.Store; 
 if (store.IsConversationEnabled == true) 
 { 
 // Obtain a Conversation object. 
 Outlook.Conversation conv = 
 mailItem.GetConversation(); 
 // Check for null Conversation. 
 if (conv != null) 
 { 
 // Obtain Table that contains rows 
 // for each item in the conversation. 
 Outlook.Table table = conv.GetTable(); 
 Debug.WriteLine("Conversation Items Count: " + 
 table.GetRowCount().ToString()); 
 Debug.WriteLine("Conversation Items from Table:"); 
 while (!table.EndOfTable) 
 { 
 Outlook.Row nextRow = table.GetNextRow(); 
 Debug.WriteLine(nextRow["Subject"] 
 + " Modified: " 
 + nextRow["LastModificationTime"]); 
 } 
 Debug.WriteLine("Conversation Items from Root:"); 
 // Obtain root items and enumerate the conversation. 
 Outlook.SimpleItems simpleItems 
 = conv.GetRootItems(); 
 foreach (object item in simpleItems) 
 { 
 // In this example, enumerate only MailItem type. 
 // Other types such as PostItem or MeetingItem 
 // can appear in the conversation. 
 if (item is Outlook.MailItem) 
 { 
 Outlook.MailItem mail = item 
 as Outlook.MailItem; 
 Outlook.Folder inFolder = 
 mail.Parent as Outlook.Folder; 
 string msg = mail.Subject 
 + " in folder " + inFolder.Name; 
 Debug.WriteLine(msg); 
 } 
 // Call EnumerateConversation 
 // to access child nodes of root items. 
 EnumerateConversation(item, conv); 
 } 
 } 
 } 
 } 
} 
 
 
void EnumerateConversation(object item, 
 Outlook.Conversation conversation) 
{ 
 Outlook.SimpleItems items = 
 conversation.GetChildren(item); 
 if (items.Count > 0) 
 { 
 foreach (object myItem in items) 
 { 
 // In this example, enumerate only MailItem type. 
 // Other types such as PostItem or MeetingItem 
 // can appear in the conversation. 
 if (myItem is Outlook.MailItem) 
 { 
 Outlook.MailItem mailItem = 
 myItem as Outlook.MailItem; 
 Outlook.Folder inFolder = 
 mailItem.Parent as Outlook.Folder; 
 string msg = mailItem.Subject 
 + " in folder " + inFolder.Name; 
 Debug.WriteLine(msg); 
 } 
 // Continue recursion. 
 EnumerateConversation(myItem, conversation); 
 } 
 } 
} 
 

```




## Related Topics

[MailItem オブジェクト](14197346-05d2-0250-fa4c-4a6b07daf25f.md)

[MailItem オブジェクトのメンバー](1094d7df-ee80-a4b0-5a21-db2979506e6b.md)




