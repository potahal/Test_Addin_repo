

---
ms.Toctitle:ユーザー設定フォームのフォーム領域の場所を指定します。
title:ユーザー設定フォームのフォーム領域の場所を指定します。
ms.ContentId:c617f6a3-c39a-bb0f-37ff-1ea999dac8be
---
# ユーザー設定フォームのフォーム領域の場所を指定します。




フォーム領域はユーザー設定のユーザー インターフェイスの部品で、フォームに追加することができます。複数の方法のうちのいずれかの方法で、ユーザー設定フォーム内にフォーム領域が表示されるよう指定できます。これを行うには、対応するフォーム領域マニフェスト XML ファイルで、フォーム領域 XML スキーマの **formRegionType** 要素および **displayAfter** 要素を指定します。

## 既定のページに表示する
標準フォームの既定ページに 1 つ以上のフォーム領域を表示するには、複数の方法があります。

### 既定のページにフォーム領域を追加するのには


- フォーム領域マニフェスト XML ファイル、 **formRegionType**要素の値として**adjoining**を指定します。




フォーム領域は、元の標準フォームの既定ページの下部に追加され、インスペクターまたは閲覧ウィンドウに表示されます。



たとえば、標準メッセージ フォームの既定ページの下部にフォーム領域を追加するには、フォーム領域のフォーム領域マニフェスト XML ファイルで以下を指定します。

```sourcecode
<formRegionType>adjoining</formRegionType>
```




作成されたユーザー設定フォームを使用して、元の標準フォームと同じメッセージ クラスのアイテムを表示すること、またはユーザー設定フォームに派生メッセージ クラスを割り当て、そのユーザー設定フォームを使用して派生メッセージ クラスのアイテムのみを表示することができます。



### 既定のページに複数のフォーム領域を追加するのには

1. 各フォーム領域の対応するフォーム領域マニフェスト XML ファイルで、**formRegionType** 要素の値として adjoining を指定します。
2. 既定ページに最初のフォーム領域として表示されるフォーム領域を除くその他のフォーム領域それぞれについて、対応するフォーム領域マニフェスト XML ファイルで、そのフォーム領域の前に表示するフォーム領域の内部名を **displayAfter** 要素の値として指定します。

作成されたユーザー設定フォームを使用して、元の標準フォームと同じメッセージ クラスのアイテムを表示すること、またはユーザー設定フォームに派生メッセージ クラスを割り当て、そのユーザー設定フォームを使用して派生メッセージ クラスのアイテムのみを表示することができます。



最初のフォーム領域は、元の標準フォームの既定のページの下部に追加され、対応する**displayAfter**要素で指定した順序で、他のフォーム領域に追加されます。



たとえば、3 つのフォーム領域、A、B、および C (内部名はそれぞれ FormRegionA、FormRegionB、および FormRegionC) を、A、B、C の順番で表示されるように指定する場合、A のフォーム領域マニフェスト XML ファイルで、以下を指定します。

```sourcecode
<formRegionType>adjoining</formRegionType>
```




B のフォーム領域マニフェスト XML ファイルで、以下を指定します。

```sourcecode
<formRegionType>adjoining</formRegionType> 
<displayAfter>FormRegionA</displayAfter>
```




C のフォーム領域マニフェスト XML ファイルで、以下を指定します。

```sourcecode
<formRegionType>adjoining</formRegionType> 
<displayAfter>FormRegionB</displayAfter>
```


>[!NOTE]
>**displayAfter** 要素を使用して、ユーザー設定フォーム内の、複数の隣接するフォーム領域の順番を指定できます。ただし、この順番は、フォームがユーザーのローカル コンピューターに初めて表示される場合に限り有効です。ユーザーは、フォームを開き、フォーム領域ヘッダーのショートカット メニューを使用して、既定ページでフォーム領域を上下に移動することで、隣接するフォーム領域の順番を変更できます。更新された順番はキャッシュされ、フォームの以後の表示ではそのキャッシュされた順番が使用されます。





### [置換] で、フォーム領域全体の既定のページに

1. フォーム領域マニフェスト XML ファイルで、**formRegionType** 要素の値として replace を指定します。
2. フォーム領域を Windows レジストリに登録するとき、ローカル マシン キー (HKEY_LOCAL_MACHINE¥Software¥Microsoft¥Office¥Outlook¥FormRegions) または現在のユーザー キー (HKEY_CURRENT_USER¥Software¥Microsoft¥Office¥Outlook¥FormRegions) の下に、このフォーム領域の派生メッセージ クラスの個別キーを作成します。REG_SZ 型の値を追加し、キーの名前としてフォーム領域の内部名を指定し、キーのデータとしてフォーム領域マニフェスト XML ファイルへの絶対ローカル ファイル パス名を指定します。

交換する場合は""標準フォームの既定のページと、実際には標準フォームをテンプレートとして使用し、既定のページとして、フォームの領域を持つ新しいユーザー設定フォームを作成しています。元の標準的なフォームは、他のフォーム ページまたは個別フォーム領域を含む、ユーザー設定フォームの一部として残ります。



作成されたカスタム フォームを派生メッセージ クラスを割り当てるし、そのメッセージ クラスのアイテムを表示するフォームを使用する必要があります。



たとえば、CustomPage という内部名のフォーム領域を作成し、c:¥Form Regions¥ にフォーム領域マニフェスト XML ファイル CustomPage.xml があるとします。このフォーム領域を使用して標準メッセージ フォームの既定ページを置き換えるには、CustomPage のフォーム領域マニフェスト XML ファイルで以下を指定します。

```sourcecode
<formRegionType>replace</formRegionType>
```




このフォーム領域を Windows レジストリに登録するとき、元の標準フォーム **IPM.Note** のメッセージ クラスは指定しないで、派生メッセージ クラス (**IPM.Note.CustomPage** など) を指定する必要があります。この例の場合、キー IPM.Note.CustomPage を作成して、現在のユーザー キー HKEY_CURRENT_USER¥Software¥Microsoft¥Office¥Outlook¥FormRegions の下にフォーム領域を登録します。次に、REG_SZ 型の値を追加し、キーの名前としてフォーム領域の内部名 CustomPage を指定し、キーのデータとしてフォーム領域マニフェスト XML ファイルへの絶対ローカル ファイル パス名 c:¥Form Regions¥CustomPage.xml を指定します。



### 標準フォーム全体、フォーム領域を [置換] を

1. フォーム領域マニフェスト XML ファイルで、**formRegionType** 要素の値として replaceall を指定します。
2. フォーム領域を Windows レジストリに登録するとき、ローカル マシン キー (HKEY_LOCAL_MACHINE¥Software¥Microsoft¥Office¥Outlook¥FormRegions) または現在のユーザー キー (HKEY_CURRENT_USER¥Software¥Microsoft¥Office¥Outlook¥FormRegions) の下に、このフォーム領域の派生メッセージ クラスの個別キーを作成します。REG_SZ 型の値を追加し、キーの名前としてフォーム領域の内部名を指定し、キーのデータとしてフォーム領域マニフェスト XML ファイルへの絶対ローカル ファイル パス名を指定します。

「置換する」標準フォーム全体、フォーム領域、ときに実際には標準フォームをテンプレートとして使用し、既定のページとしてフォーム領域を持つ新しいユーザー設定フォームを作成しています。元の標準的なフォームには、他のフォーム ページまたは個別フォーム領域が含まれている場合、しないままになります、ユーザー設定フォームの一部として。



作成されたカスタム フォームを派生メッセージ クラスを割り当てるし、そのメッセージ クラスのアイテムを表示するフォームを使用する必要があります。



たとえば、CustomMessage という内部名のフォーム領域を作成し、c:¥Form Regions¥ にフォーム領域マニフェスト XML ファイル CustomMessage.xml があるとします。CustomMessage を既定ページとして含む新しいユーザー設定フォームのテンプレートとして標準メッセージ フォームを使用するには、CustomMessage のフォーム領域マニフェスト XML ファイルで、以下を指定します。

```sourcecode
<formRegionType>replaceall</formRegionType>
```




このフォーム領域を Windows レジストリに登録するとき、派生メッセージ クラス (**IPM.Note.CustomMessage** など) を指定します。この例の場合、キー IPM.Note.CustomMessage を作成して、現在のユーザー キー HKEY_CURRENT_USER¥Software¥Microsoft¥Office¥Outlook¥FormRegions の下にフォーム領域を登録します。次に、REG_SZ 型の値を追加し、キーの名前としてフォーム領域の内部名 CustomMessage を指定し、キーのデータとしてフォーム領域マニフェスト XML ファイルへの絶対ローカル ファイル パス名 c:¥Form Regions¥CustomMessage.xml を指定します。





## 既定のページ以外のページで
1 つ以上のフォーム領域を個別ページとして標準フォームに追加できます。

### 個別のページにフォーム領域を追加するのには

- フォーム領域マニフェスト XML ファイル、 **formRegionType**要素の値として**個別**に指定します。

フォーム領域は、元の標準フォームの既存のすべてのページの後に個別ページとして追加され、インスペクターでスタンドアロン ページとして表示されます。



たとえば、標準連絡先フォームにフォーム領域を個別ページとして追加するには、フォーム領域のフォーム領域マニフェスト XML ファイルで以下を指定します。

```sourcecode
<formRegionType>separate</formRegionType>
```




フォーム領域は、標準連絡先フォームの [**すべてのフィールド**] ページの後に個別ページとして表示されます。



作成されたユーザー設定フォームを使用して、元の標準フォームと同じメッセージ クラスのアイテムを表示すること、またはユーザー設定フォームに派生メッセージ クラスを割り当て、そのユーザー設定フォームを使用して派生メッセージ クラスのアイテムのみを表示することができます。



### 個別のページとして複数のフォーム領域を追加するのには

1. 各フォーム領域には、対応するフォーム領域マニフェスト XML ファイルで指定**別****formRegionType**要素の値として。
2. ユーザー設定フォームに最初のフォーム領域として表示されるフォーム領域を除くその他のフォーム領域それぞれについて、対応するフォーム領域マニフェスト XML ファイルで、そのフォーム領域の前に表示するフォーム領域の内部名を displayAfter**displayAfter** 要素の値として指定します。

作成されたユーザー設定フォームを使用して、元の標準フォームと同じメッセージ クラスのアイテムを表示すること、またはユーザー設定フォームに派生メッセージ クラスを割り当て、そのユーザー設定フォームを使用して派生メッセージ クラスのアイテムのみを表示することができます。



最初のフォーム領域は、元の標準的なフォームの別のページとして追加して、対応する**displayAfter**要素で指定した順序で、他のフォーム領域に追加されます。



たとえば、3 つの個別フォーム領域、A、B、および C が内部の名前**FormRegionA**、 **FormRegionB**、および A、B、および C の順序で別々 のページとして表示するのには、 **FormRegionC**を注文する場合を指定します次 a のフォーム領域マニフェスト XML ファイル。

```sourcecode
<formRegionType>separate</formRegionType>
```




B のフォーム領域マニフェスト XML ファイルで、以下を指定します。

```sourcecode
<formRegionType>separate</formRegionType>
<displayAfter>FormRegionA</displayAfter>
```




C のフォーム領域マニフェスト XML ファイルで、以下を指定します。

```sourcecode
<formRegionType>separate</formRegionType>
<displayAfter>FormRegionB</displayAfter>
```







