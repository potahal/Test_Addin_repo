
# Office Fluent ??????

## 


 **??**  ??? Microsoft Office ???????????? CommandBars ???????Microsoft Office Fluent ???? ??????????????? ?????????????????????????????????????? "???" ??????????

Office Fluent ?????????????? Office ??????????????????????? ??????????????????????????????????????????????????????????? ?????????????????????????? ?????????????? ?????????????? ??????????????????????????????????????????????? (RibbonX) ?????????? ?????????????????????????????????????????????????????? (XML) ????????????????????? 1 ????????XML ????? ??????????????? ???????????? ?????????????? XML ?????????????????????????????????????? ???????????????????? ???????????????????????????????Word?Excel?Access???? PowerPoint??????????? ?????????????
XML ?????? ??????????????????????? **CommandBars** ?????? ?????????????????????????????????????????????? Office ??????????????????????????????????????????????Word?Excel???? PowerPoint ???????????????? ???????????????????????? 1 ?????????

- ????? ????????????? ????? COM ???????
    
- ??????????????? (.ppam ????? .xlam ??????) ???
    
- Word ??????? (.dotm ????) ?????
    

???COM ??????????????????? ???????????? XML ?? XML ??????????????????????????????????????????? XML ????????????????????????Microsoft Office ??XML ??????? XSD ??????????????????????????????????????????????????????????????????? ?????????????????????????? ?????? ??????????????? XML ?????????? Open XML ?????? (???? .docx, .docm, .xlsx, .xlsm, .pptx???? .pptm) ?????????????XML ??????????????? ????????????????????????Open XML ??????????????????? ????????????????????Office ?????????????????????????? ?????????????????????????????????????????????????????????????????????????????????
 **??????????????**
Office 2007 ??????????? Microsoft Office ???????  **CommandBars** ?????? ?????????UI ????? Microsoft Visual BasicR ???????????????????Office ??????? ??????????????????????????Office 2003 ???? ???????????????Office ? **[????]** ??????????????????????????????????????????????????Office ???????????? ( **[????]** ????? **[??]** ????? **[???]** ??????) ???????????? **[???? ????]** ?????????????????????????? ?? ( **[??]** ??? ??? **[????]** ??? ??? **[?]** ??? ????) ???????????? **[??? ?? ????]** ?????????????????????????????????????????? ??? **[????]** ??? **[????????????]** ????????????
 **?????? ??????????????????**
???????????????????????????? UI ??????????????????????????????? RibbonX ???????????????  **onAction** ?????? ???????????? `<button id="myButton" onAction="MyButtonOnAction" />` ?????????????????????????? MyButtonOnAction ????????? Office ????????MyButtonOnAction ????????????????????????????Microsoft Visual C# ???????????



```C#
public void MyButtonOnAction (IRibbonControl control) 
   { 
      if (control.Id=="myButton") 
      { 
         System.Windows.Forms.MessageBox.Show("Button clicked!"); 
      } 
   } 
```

 **COM ?????????????????????**
???????? ??????????????????????????????????????????????????????????????????? COM ??????????? COM ??????????????????????????????

1. COM ???? ???????????????????????????? COM ???????????? Extensibility.IDTExtensibility2 ?????????????Microsoft.Office.Core ???????  **IRibbonExtensibility** ?????????????????????
    
2. ??????????????????????????????????????????
    
3. Office ??????????????? ?????????????????????? Office ??????????????? IDTExtensibility2::OnConnection ???????????
    
4. ??? **QueryInterface** ??????????? **IRibbonExtensibility** ????????????????????????????
    
5. ?????????? **IRibbonExtensibility::GetCustomUI** ???????????XML ?????? ????????????????????? XML ???????? XML ?????????????????????????????????????
    
6. ?????????????????? UI ??????????????
    

 **Office Open XML ????????????????????????**
XML ??????????? UI ???????????????????????

1. ??????? ???????????? ??????????????????????????????????????????????????????????? XML ?????????????????????customUI.xml?????????????
    
2. ???????  **customUI** ?????????????????????????????? ????????????
    
3. XML ?????????????? UI ???????????????
    
     **??**  ????????????
4. Office ???????????????????? _.docx_ ? _.docm_ ? _.xlsx_ ? _.xlsm_ ? _.pptm_ ? _.pptx_ ????????????? Open XML ??????????????? ???????????????????????????? _m_ ????RibbonX ???????????????????????????????????
    
5. ?????? ??????  _.zip_ ??????????????????
    
6. ?????? ??????????????????????????????????????
    
7. .zip ????????  **.rels** ??????????????????.rels ???????? **_rels** ?????????????????????
    
8. .rels ?????????????? ??????????? ???????????? 1 ??????????????????
    
9. _rels ?????????????????????????????????
    
10. ??????? .zip ??????????????????? Office ?????????????????????????????????
    

 **XML ?????? ???????????**
???????????????XML ????????????????????Word ???????????????????? XML ?????? ???????????????????



```XML
<customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui"> 
  <ribbon> 
    <tabs> 
      <tab idMso="TabHome"> 
        <group idMso="GroupFont" visible="false" /> 
      </tab> 
      <tab id="CustomTab" label="My Tab"> 
        <group id="SampleGroup" label="Sample Group"> 
          <toggleButton id="ToggleButton1" size="large" label="Large Toggle Button" getPressed="MyToggleMacro"  /> 
          <checkBox id="CheckBox1" label="A CheckBox" screentip="This is a check box" onAction="MyCheckboxMacro" /> 
          <editBox id="EditBox1" getText="MyTextMacro" label="My EditBox" onChange="MyEditBoxMacro"/> 
          <comboBox id="Combo1" label="My ComboBox" onChange="MyComboBoxMacro"> 
            <item id="Zip1" label="33455" /> 
            <item id="Zip2" label="81611" /> 
            <item id="Zip3" label="31561" /> 
          </comboBox> 
          <advanced> 
            <button id="Launcher1" screentip="My Launcher" onAction="MyLauncherMacro" /> 
          </advanced> 
        </group> 
        <group id="MyGroup" label="My Group" > 
          <button id="Button" label="My Large Button" size="large" onAction="MyButtonMacro" /> 
          <button id="Button2" label="My Normal Button" size="normal" onAction="MyOtherButtonMacro" /> 
        </group > 
      </tab> 
    </tabs> 
  </ribbon> 
</customUI> 

```

?????????Word ????????????????????????

1. ??????????????????????????
    
2. ????? [ **???**] ?????????? [ **GroupFont**] ?????????????
    
3. ?????????????????? [ **CustomTab**] ?????????
    
     **??**  ???????????????????????????  _id= identifier_ ???????[ **TabHome**] ???????????????????  _idMso= identifier_ ?????????
4. ??? [ **SampleGroup**] ????? [ **My Tab**] ?????????
    
5. ??????? ToogleButton1 ???? [ **My Group**] ?????onAction ??????? GetPressed ?????????????
    
6. CheckBox1 ???? ??????????????? ?????? [ **My Group**] ?????onAction ?????????????
    
7. EditBox1 ????? ????? [ **My Group**] ?????onChange ?????????????
    
8. Combo1 ??? ????? 3 ??????? [ **My Group**] ???????????? ???????????????????? onChange ?????????????
    
9. onAction ?????????????? Launcher1 ???????? [ **My Group**] ??????? ???????????????????????????????????????? ????????????
    
10. ??? [ **MyGroup**] ?????????????????????
    
11. ??????? Button1 ???? [ **MyGroup**] ?????onAction ?????????????
    
12. ???????????????????? Button1 ???? [ **MyGroup**] ?????onAction ?????????????
    

 **??????? ?? ?????????**
COM ??????????????????????????????????????????????????? Office ??? **CommandBars** ?????? ??????????????????????????????? ??????????????????? Office ??????????????? ???????????????????????????? **CommandBars** ?????? ????????????????????????????? (WordBasic?XLM ??) ?????????? [ **????**] ???????????????????????????????????????????
 **???????????**
????????????????????????????????????????????? 1 ????????????????????????CustomUI ??? onLoad ??????????????????????????????????RibbonX ?????? ????????????????? 1 ????????????? IRibbonUI ???????????? ?????????IRibbonUI ??????????????????????????????????
XML ???????????:
 `<customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui" onLoad="ribbonLoaded">`
C# ???: ???????????????????



```C#
IRibbonUI myRibbon; 
 
     public void ribbonLoaded(IRibbonUI ribbon) { 
         myRibbon = ribbon; 
     } 
```

??????????????? Office ????????????????????????????????????????????????????? XML ???????????????? XML ?????????????????????????????????XML ??????? 1 ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
