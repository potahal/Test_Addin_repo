

---
ms.Toctitle:アドレス帳から名前を表示する
title:アドレス帳から名前を表示する
ms.ContentId:32e7179c-8133-ee20-ecf6-52c9275f205f
---
# アドレス帳から名前を表示する




このトピックでは、アドレス帳について説明すると共に、アドレス帳にある名前をプログラムによって [Outlook アドレス帳] ダイアログ ボックスに表示する方法を示します。



Outlook は、セッションで使用されるアドレス帳の階層を維持しています。トランスポート プロバイダーによってメッセージが配信されるようにするためには、この階層内のアドレス帳のいずれかに受信者のアドレス エントリが含まれている必要があります。  



アドレス帳には 1 つまたは複数のアドレス一覧が含まれます。それぞれのアドレス一覧は、ユーザー、配布リスト、またはその他の種類のアドレス エントリから構成されます。アドレス一覧の 1 つの例として、Exchange のグローバル アドレス一覧があります。Outlook のユーザー インターフェイスでは、[アドレス帳] ダイアログ ボックスを開くことにより、アドレス一覧にある名前を確認して選択できるようになっています。メール アイテムや予定アイテムを作成したり、タスクアイテムを割り当てたりするときは、アドレス帳を使用すると受信者を簡単に選択できます。 



Outlook アドレス帳は、Outlook によって自動的に作成されるアドレス一覧または複数のアドレス一覧のセットです。既定では、このアドレス帳には連絡先フォルダーに対応するアドレス一覧が 1 つ含まれ、フォルダー内の連絡先のうち、少なくとも 1 つの電子メール アドレスまたは FAX 番号のエントリのある連絡先が列挙されます。連絡先を保存する他のフォルダーを作成すると、既定では、作成した各フォルダーも Outlook アドレス帳のアドレス一覧になります。フォルダーの [**プロパティ**] ダイアログ ボックスの [**Outlook アドレス帳**] タブでは、[**電子メールのアドレス帳にこのフォルダーを表示する**] チェック ボックスをオンまたはオフにできます。



プログラミングの観点から見ると、Outlook は、現在のセッションで使用されるアドレス一覧のコレクション (**AddressLists**) を維持しています。それぞれのアドレス一覧 (**AddressList**) は、アドレス エントリのコレクション (**AddressEntries**) で構成されます。アドレス一覧には **OlAddressListType** で列挙されるようにいくつかの種類があり、アドレス エントリにも **OlAddressEntryUserType** で列挙されるようにいくつかの種類があります。連絡先を保存するフォルダーを追加するときは、**Folder.ShowAsOutlookAB** を使用して、そのフォルダーが Outlook アドレス帳にアドレス一覧として表示されるようにするかどうかを指定できます。



**Recipient** オブジェクトは、**Recipient.Address** プロパティで指定される **AddressEntry** オブジェクトに関連付けられています。**AddressEntry.AddressEntryUserType** プロパティを使用すると、受信者の種類を確認することもできます。たとえば、受信者が連絡先アイテムであるか、Exchange ユーザーであるか、または Exchange 配布リストであるかを判別できます。



**SelectNamesDialog** オブジェクトを使用すると、アドレス一覧にある名前を、Outlook のユーザー インターフェイスの [**名前の選択**] ダイアログ ボックスと同様のダイアログ ボックスに表示できます。次の図は、連絡先フォルダーを表示している [**名前の選択**] ダイアログ ボックスの例です。

![](..\media\olSelectNamesDialog_ZA10082109.gif)




このダイアログ ボックスでは、ユーザーがアドレス帳の中の 1 つまたは複数のアドレス一覧からエントリを選択することができ、選択された受信者は **SelectNamesDialog.Recipients** プロパティに返されます。**SelectNamesDialog** オブジェクトのプロパティおよびメソッドを使用すると、ダイアログ ボックスの次のような動作を制御できます。

- ダイアログ ボックスに表示される初期のアドレス一覧と、そのアドレス一覧だけを表示するかどうか。
- 受信者を選択するフィールドの数。たとえば、[宛先]、[ＣＣ]、および [ＢＣＣ] の 3 つのラベルをすべて表示するかどうか。
- タイトルを表す文字列と、[**宛先**]、[**ＣＣ**]、および [**ＢＣＣ**] を表示する場合はそれらのラベルを表す文字列。タイトルやラベルが長すぎる場合は、ダイアログ ボックスの幅が広がるのではなく、文字列が切り捨てられます。
- ユーザーが一度に 1 つ以上のアドレス エントリを選択できるかどうか。
- ダイアログ ボックスを閉じる前に、受信者の名前を解決するかどうか。
- 解決できない受信者が存在する場合にどうするか。








アドレス一覧から名前を表示するダイアログ ボックスを表示するには、次の操作を行います。

1. **Application.Session**
             で示される現在のセッションの **GetSelectNamesDialog** メソッドを使用して、現在のセッションに対する **SelectNamesDialog** オブジェクトのインスタンスを取得します。
2. 現在のセッションの **AddressLists** プロパティを使用して、現在のセッションに対する **AddressLists** コレクションを取得します。
3. 既定では、ダイアログ ボックスは **AddressList.IsInitialAddressList** が **True** に設定されているアドレス一覧で初期化されます。必要に応じて **SelectNamesDialog.InitialAddressList** を使用すると、手順 2 で取得した **AddressLists** コレクション内の別の **AddressList** でダイアログ ボックスを初期化できます。
4. **SelectNamesDialog.Display** を使用してダイアログ ボックスを表示します。このメソッドは、**SelectNamesDialog.ForceResolution** の値とユーザーの応答によって、**True** または **False** を返します。
    - **SelectNamesDialog.ForceResolution** が設定されていてすべての名前が解決された場合、ユーザーが [**OK**] をクリックすると、**True** が返されます。
    - **SelectNamesDialog.ForceResolution** が設定されているものの受信者の一部が解決されなかった場合、**False** が返されます。
    - **SelectNamesDialog.ForceResolution** が設定されていない場合、ユーザーが [**OK**] をクリックすると、**False** が返されます。
    - ユーザーが [**キャンセル**] または [**閉じる**] アイコンをクリックすると、**False** が返されます。

5. **SelectNamesDialog.Display** から **True** が返されたら、**SelectNamesDialog.Recipients** を使用して選択されたアドレス エントリを取得します。






## Related Topics

[使い方: ストアのグローバル アドレス一覧またはアドレス一覧のセットを調べる](2cca6dc2-883d-b8cf-cd60-98614d2fb673.md)




