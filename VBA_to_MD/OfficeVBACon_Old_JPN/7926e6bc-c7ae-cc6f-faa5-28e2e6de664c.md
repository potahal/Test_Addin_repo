
# ???? COM ????????? Office Fluent ????????????

Microsoft Office ????? Microsoft Office Fluent ???? ???????????? ??????????????????? Office ?????????????????????????? (RibbonX) ????????????????? XML ???????????????????????????????

?????????????????????????????Office ???????????????????????????????????????????? COM ????????????????? ???????????????Microsoft Visual C# ????? Microsoft Visual Studio 2012 ??????????????????????????? ??????? ???????????? ?????????????????????????????????????

1. XML ?????? ???????????
    
2. C# ?????????? COM ???? ??????? Microsoft Visual Studio 2012 ???????
    
3. XML ?????? ?????????????????????????????
    
4.  **IRibbonExtensibility** ???????????????
    
5. ???????????????????????? ???????????
    
6. ??????????????????????????????
    
 **XML ?????? ?????????**
??????????? ??????????????????????????? 

1. ???? ?????????? XML ????????????? 
    
  ```XML
  <customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui"> 
  <ribbon> 
    <tabs> 
      <tab id="CustomTab" label="My Tab"> 
        <group id="SampleGroup" label="Sample Group"> 
          <button id="Button" label="Insert Company Name" size="large" onAction="InsertCompanyName" /> 
        </group > 
      </tab> 
    </tabs> 
  </ribbon> 
</customUI> 

  ```

2. ?????????? **customUI.xml**????????????????
    

 **???? COM ???? ???????????**
???????COM ???? C# ??????? Microsoft Visual Studio 2012 ???????

1. Microsoft Visual Studio 2012 ???????
    
2.  **[????]** ????? **[?????????]** ?????????
    
3.  **[?????????]** ????? ????? **[?????????]** ???? **[??????????]** ????? **[??????????]** ???????? **[??????]** ????????????
    
4. ?????????????????????? **RibbonXSampleCS**????????
    
5.  **?????? ?????**???????? **[??]** ?????????
    
6.  **[Visual C# ????????????]** ????? **[??]** ?????????
    
7.  **[Microsoft Word]** ??????????????? **[??]** ?????????
    
8. ??????????????? **[??]** ?????????
    
9.  **[???? ???????????]** ???? **[??? ????????????????????????]** ??????? **[??]** ?????????
    
10.  **[??]** ???????????????????
    

 **?????????????????**
???????Word ?????????????????????? ???????????????? 

1. ??????? ?????????  **[??]** ???????? **[?????]** ?????????
    
     **??**   **[??]** ???????????????? **[??????]** ??????????? **[???????????]** ?????????
2.  **[.NET]** ???????????? **Ctrl** ?????? **[Microsoft.Office.Interop.Word]** ???????
    
3.  **[COM]** ???????????? **[Microsoft Office 15.0 Object Library]** (????????? Office ???????????????) ?????? **[OK]** ?????????
    
4. ??????????????????????????? ( **namespace** ???) ???????
    
  ```C#
  using System.Reflection; 
using Microsoft.Office.Core; 
using System.IO; 
using System.Xml; 
using Extensibility; 
using System.Runtime.InteropServices; 
using MSword = Microsoft.Office.Interop.Word; 

  ```


 **?????? ????????????????????**
???????XML ?????? ?????????????????????????????

1. ??????? ?????????  **[RibbonXSampleCS]** ???????? **[??]** ???????? **[?????]** ?????????
    
2. ????  **customUI.xml** ??????????????????? **[??]** ?????????
    
3. ??????? ?????????  **[customUI.xml]** ????????? **[?????]** ???????
    
4.  **[?????]** ?????? **[??? ?????]** ????? **[??????????]** ?????????????
    

 **IRibbonExtensibility ?????????????**
??????????? Word ???????????????????????? Extensibility.IDTExtensibility2::OnConnection ?????????? **IRibbonExtensibility** ??????????????????? **GetCustomUI** ???????

1. ??????? ?????????? **[Connect.cs]** ???????? **[??????]** ?????????
    
2.  **Connect** ??????????????????????????? **Word ????????** ?????????????????
    
     `private MSword.Application applicationObject;`
    
3. ?????  **OnConnection** ???????????????????????? **Word ????????** ????????????????????
    
     `applicationObject =(MSword.Application)application;`
    
4. ????? ???? Connect ???????????????????? **IRibbonExtensibility** ????????
    
     **??**  Microsoft IntelliSense ????????????????? ?????????????????????? ???? Connect: ??????????? ? **IRibbonExtensibility** ????????????? **[???????????]** ??????? **[???????????????]** ??????????????? **GetCustomUI** ????????????????????????????????????

  ```C#
  string IRibbonExtensibility.GetCustomUI(string RibbonID) 
{ 
}
  ```

5. ??????????  **GetCustomUI** ??????????????????????? `return GetResource("customUI.xml");`
    
6. ????????  **GetCustommUI** ?????????????
    
  ```C#
  private string GetResource(string resourceName) 
        { 
            Assembly asm = Assembly.GetExecutingAssembly(); 
            foreach (string name in asm.GetManifestResourceNames()) 
            { 
                if (name.EndsWith(resourceName)) 
                { 
                    System.IO.TextReader tr = new System.IO.StreamReader(asm.GetManifestResourceStream(name)); 
                    //Debug.Assert(tr != null); 
                    string resource = tr.ReadToEnd(); 
 
                    tr.Close(); 
                    return resource; 
                } 
            } 
            return null; 
        } 

  ```


     **GetCustomUI** ????? **GetResource** ???????????? **GetResource** ????????????????????????????customUI.xml ??????????????????????????????????????XML ???????????????????????? **StreamReader** ??????????????????????????? XML ? **GetCustomUI** ??????????????? XML ??????????????XML ????????????????????????? **GetCustomUI** ???????????????????
    
7.  **GetResource** ?????????????????????????????????????????????????????
    
  ```C#
  public void InsertCompanyName(IRibbonControl control) 
        { 
        // Inserts the specified text at the beginning of a range or selection. 
            string MyText; 
            MyText = "Microsoft Corporation"; 
 
            MSword.Document doc = applicationObject.ActiveDocument; 
 
            //Inserts text at the beginning of the active document. 
            object startPosition = 0; 
            object endPosition = 0; 
            MSword.Range r = (MSword.Range)doc.Range( 
                   ref startPosition, ref endPosition); 
            r.InsertAfter(MyText); 
        } 

  ```


 **????????????????????**
?????????????????????? ?????????????????????Word ????????????????

1.  **[??????]** ????? **[???????????]** ??????????????????????????????????????
    
2. ??????? ?????????? **[RibbonXSampleCSSetup]** ???????? **[???]** ?????????
    
3.  **[RibbonXSampleCSSetup]** ?????????? **[??????]** ???????? **RibbonXSampleCSSetup ?????? ?????**???????
    
4. ????  **[??]** ????????????? **[???]** ?????????
    
5. Word ??????????????  **[My Tab]** ??????????
    

 **????????????**
 **[My Tab]** ????????? **[Insert Company Name]** ??????????????????????????????????????????????????????????????????Windows ??????????????????????????????

 **??**  ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????Microsoft ???????????? **256986 Microsoft Windows ????????**???????????


1. ??????? ???????????????? ???????  **[RibbonXSampleCSSetup]** ???????? **[??]** ????????? **[?????]** ?????????
    
2.  **[?????]** ?????????????????? ?????????HKCU\Software\Microsoft\Office\Word\AddIns\RibbonXSampleCS.Connect
    
     **??**   **[RibbonXSampleCS.Connect]** ?????????????????????????????????? **[????]** ????????????? **[??]** ???????? **[??]** ????????????? **RibbonXSampleCS.Connect**????????????? **LoadBehavior** ??????? **DWord** ??????????? **3**????????

